import{a as ld,b as cd,c as dd,d as ud,e as hd,f as Ii,g as fd,h as xt,i as md,j as pd,k as gd,l as _d,n as yd,o as ds}from"./chunk-Q4DUVQO3.js";import{a as Cr,b as Gc,c as In,d as Sr,e as cs,f as Kc,g as Qc,h as Tn,i as En,l as Hc,m as $c,n as Wc,o as nd,p as kr,q as wi,r as Xe,s as bi,t as Pr,u as Fr,v as Mr,w as rd,x as Vr}from"./chunk-GQBSQ4P4.js";import{a as Yc,b as Cn,c as Xc,d as Jc,e as Zc,f as ed,g as td,h as id,j as Rr}from"./chunk-LSQIOU6O.js";import{a as od,b as sd,c as ad,d as Nr}from"./chunk-O4ISVVFI.js";import{G as ls,H as Dr,J as Ar,a as xr,f as wr,i as br,k as as,p as zc,r as Ir,s as Tr,v as Er,w as Uc,x as bn,z as Fe}from"./chunk-UOJAND7T.js";import"./chunk-XGEOXIXV.js";import"./chunk-WXI33M2S.js";import{d as Zt,f as qc,h as jc,i as Mt}from"./chunk-X4B3MZWB.js";import{A as Bc,B as yn,Bb as Xt,Ca as ss,Cb as yi,Db as nt,Eb as Ye,Fb as wn,Gb as qe,H as Kt,Hb as je,Jb as J,Lb as Jt,Mb as Pe,Nb as ge,Qa as ce,Ra as k,S as yr,Ta as $e,Tb as vi,U as pi,Ub as xi,Wb as rt,Z as _t,Za as Be,_ as Ee,_a as gi,a as He,aa as Ve,ab as ne,b as gr,bb as yt,ca as fe,d as P,da as ke,fa as ie,fb as de,ga as pe,gb as $t,ha as Ce,hb as We,ia as K,j as Ge,jb as it,k as Nc,mb as Ft,n as Oc,na as Qt,o as _n,oa as kt,pa as Pt,q as Lc,qb as z,ra as Ne,rb as j,sa as vr,sb as vt,ta as Ht,tb as Wt,ub as Yt,va as ve,vb as Oe,wa as vn,wb as _i,x as _r,xb as xn,zb as Ke}from"./chunk-6CRNKGI6.js";var xf=[[["caption"]],[["colgroup"],["col"]],"*"],wf=["caption","colgroup, col","*"];function bf(n,e){n&1&&nt(0,2)}function If(n,e){n&1&&(z(0,"thead",0),Oe(1,1),j(),z(2,"tbody",0),Oe(3,2)(4,3),j(),z(5,"tfoot",0),Oe(6,4),j())}function Tf(n,e){n&1&&Oe(0,1)(1,2)(2,3)(3,4)}var Je=new Ve("CDK_TABLE");var zr=(()=>{let e=class e{constructor(i){this.template=i}};e.\u0275fac=function(r){return new(r||e)(k($e))},e.\u0275dir=K({type:e,selectors:[["","cdkCellDef",""]],standalone:!0});let n=e;return n})(),Ur=(()=>{let e=class e{constructor(i){this.template=i}};e.\u0275fac=function(r){return new(r||e)(k($e))},e.\u0275dir=K({type:e,selectors:[["","cdkHeaderCellDef",""]],standalone:!0});let n=e;return n})(),wd=(()=>{let e=class e{constructor(i){this.template=i}};e.\u0275fac=function(r){return new(r||e)(k($e))},e.\u0275dir=K({type:e,selectors:[["","cdkFooterCellDef",""]],standalone:!0});let n=e;return n})(),Ti=(()=>{let e=class e{get name(){return this._name}set name(i){this._setNameInput(i)}get sticky(){return this._sticky}set sticky(i){i!==this._sticky&&(this._sticky=i,this._hasStickyChanged=!0)}get stickyEnd(){return this._stickyEnd}set stickyEnd(i){i!==this._stickyEnd&&(this._stickyEnd=i,this._hasStickyChanged=!0)}constructor(i){this._table=i,this._hasStickyChanged=!1,this._sticky=!1,this._stickyEnd=!1}hasStickyChanged(){let i=this._hasStickyChanged;return this.resetStickyChanged(),i}resetStickyChanged(){this._hasStickyChanged=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(i){i&&(this._name=i,this.cssClassFriendlyName=i.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}};e.\u0275fac=function(r){return new(r||e)(k(Je,8))},e.\u0275dir=K({type:e,selectors:[["","cdkColumnDef",""]],contentQueries:function(r,s,a){if(r&1&&(Ye(a,zr,5),Ye(a,Ur,5),Ye(a,wd,5)),r&2){let c;qe(c=je())&&(s.cell=c.first),qe(c=je())&&(s.headerCell=c.first),qe(c=je())&&(s.footerCell=c.first)}},inputs:{name:[ie.None,"cdkColumnDef","name"],sticky:[ie.HasDecoratorInputTransform,"sticky","sticky",rt],stickyEnd:[ie.HasDecoratorInputTransform,"stickyEnd","stickyEnd",rt]},standalone:!0,features:[Pe([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:e}]),yt]});let n=e;return n})(),Lr=class{constructor(e,t){t.nativeElement.classList.add(...e._columnCssClassName)}},bd=(()=>{let e=class e extends Lr{constructor(i,r){super(i,r)}};e.\u0275fac=function(r){return new(r||e)(k(Ti),k(ve))},e.\u0275dir=K({type:e,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],standalone:!0,features:[ne]});let n=e;return n})();var Id=(()=>{let e=class e extends Lr{constructor(i,r){super(i,r);let s=i._table?._getCellRole();s&&r.nativeElement.setAttribute("role",s)}};e.\u0275fac=function(r){return new(r||e)(k(Ti),k(ve))},e.\u0275dir=K({type:e,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],standalone:!0,features:[ne]});let n=e;return n})(),Br=class{constructor(){this.tasks=[],this.endTasks=[]}},qr=new Ve("_COALESCED_STYLE_SCHEDULER"),hs=(()=>{let e=class e{constructor(i){this._ngZone=i,this._currentSchedule=null,this._destroyed=new Ge}schedule(i){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(i)}scheduleEnd(i){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(i)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new Br,this._getScheduleObservable().pipe(pi(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){let i=this._currentSchedule;this._currentSchedule=new Br;for(let r of i.tasks)r();for(let r of i.endTasks)r()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?Oc(Promise.resolve(void 0)):this._ngZone.onStable.pipe(Kt(1))}};e.\u0275fac=function(r){return new(r||e)(fe(Be))},e.\u0275prov=_t({token:e,factory:e.\u0275fac});let n=e;return n})();var fs=(()=>{let e=class e{constructor(i,r){this.template=i,this._differs=r}ngOnChanges(i){if(!this._columnsDiffer){let r=i.columns&&i.columns.currentValue||[];this._columnsDiffer=this._differs.find(r).create(),this._columnsDiffer.diff(r)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(i){return this instanceof Sn?i.headerCell.template:this instanceof ms?i.footerCell.template:i.cell.template}};e.\u0275fac=function(r){return new(r||e)(k($e),k(xi))},e.\u0275dir=K({type:e,features:[Qt]});let n=e;return n})(),Sn=(()=>{let e=class e extends fs{get sticky(){return this._sticky}set sticky(i){i!==this._sticky&&(this._sticky=i,this._hasStickyChanged=!0)}constructor(i,r,s){super(i,r),this._table=s,this._hasStickyChanged=!1,this._sticky=!1}ngOnChanges(i){super.ngOnChanges(i)}hasStickyChanged(){let i=this._hasStickyChanged;return this.resetStickyChanged(),i}resetStickyChanged(){this._hasStickyChanged=!1}};e.\u0275fac=function(r){return new(r||e)(k($e),k(xi),k(Je,8))},e.\u0275dir=K({type:e,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:[ie.None,"cdkHeaderRowDef","columns"],sticky:[ie.HasDecoratorInputTransform,"cdkHeaderRowDefSticky","sticky",rt]},standalone:!0,features:[yt,ne,Qt]});let n=e;return n})(),ms=(()=>{let e=class e extends fs{get sticky(){return this._sticky}set sticky(i){i!==this._sticky&&(this._sticky=i,this._hasStickyChanged=!0)}constructor(i,r,s){super(i,r),this._table=s,this._hasStickyChanged=!1,this._sticky=!1}ngOnChanges(i){super.ngOnChanges(i)}hasStickyChanged(){let i=this._hasStickyChanged;return this.resetStickyChanged(),i}resetStickyChanged(){this._hasStickyChanged=!1}};e.\u0275fac=function(r){return new(r||e)(k($e),k(xi),k(Je,8))},e.\u0275dir=K({type:e,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:[ie.None,"cdkFooterRowDef","columns"],sticky:[ie.HasDecoratorInputTransform,"cdkFooterRowDefSticky","sticky",rt]},standalone:!0,features:[yt,ne,Qt]});let n=e;return n})(),Gr=(()=>{let e=class e extends fs{constructor(i,r,s){super(i,r),this._table=s}};e.\u0275fac=function(r){return new(r||e)(k($e),k(xi),k(Je,8))},e.\u0275dir=K({type:e,selectors:[["","cdkRowDef",""]],inputs:{columns:[ie.None,"cdkRowDefColumns","columns"],when:[ie.None,"cdkRowDefWhen","when"]},standalone:!0,features:[ne]});let n=e;return n})(),ei=(()=>{let e=class e{constructor(i){this._viewContainer=i,e.mostRecentCellOutlet=this}ngOnDestroy(){e.mostRecentCellOutlet===this&&(e.mostRecentCellOutlet=null)}};e.mostRecentCellOutlet=null,e.\u0275fac=function(r){return new(r||e)(k(gi))},e.\u0275dir=K({type:e,selectors:[["","cdkCellOutlet",""]],standalone:!0});let n=e;return n})(),ps=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=pe({type:e,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],standalone:!0,features:[ge],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(r,s){r&1&&Oe(0,0)},dependencies:[ei],encapsulation:2});let n=e;return n})();var gs=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=pe({type:e,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],standalone:!0,features:[ge],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(r,s){r&1&&Oe(0,0)},dependencies:[ei],encapsulation:2});let n=e;return n})(),Td=(()=>{let e=class e{constructor(i){this.templateRef=i,this._contentClassName="cdk-no-data-row"}};e.\u0275fac=function(r){return new(r||e)(k($e))},e.\u0275dir=K({type:e,selectors:[["ng-template","cdkNoDataRow",""]],standalone:!0});let n=e;return n})(),vd=["top","bottom","left","right"],us=class{constructor(e,t,i,r,s=!0,a=!0,c){this._isNativeHtmlTable=e,this._stickCellCss=t,this.direction=i,this._coalescedStyleScheduler=r,this._isBrowser=s,this._needsPositionStickyOnElement=a,this._positionListener=c,this._cachedCellWidths=[],this._borderCellCss={top:`${t}-border-elem-top`,bottom:`${t}-border-elem-bottom`,left:`${t}-border-elem-left`,right:`${t}-border-elem-right`}}clearStickyPositioning(e,t){let i=[];for(let r of e)if(r.nodeType===r.ELEMENT_NODE){i.push(r);for(let s=0;s<r.children.length;s++)i.push(r.children[s])}this._coalescedStyleScheduler.schedule(()=>{for(let r of i)this._removeStickyStyle(r,t)})}updateStickyColumns(e,t,i,r=!0){if(!e.length||!this._isBrowser||!(t.some(s=>s)||i.some(s=>s))){this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]}));return}this._coalescedStyleScheduler.schedule(()=>{let s=e[0],a=s.children.length,c=this._getCellWidths(s,r),u=this._getStickyStartColumnPositions(c,t),f=this._getStickyEndColumnPositions(c,i),p=t.lastIndexOf(!0),I=i.indexOf(!0),E=this.direction==="rtl",S=E?"right":"left",F=E?"left":"right";for(let V of e)for(let A=0;A<a;A++){let G=V.children[A];t[A]&&this._addStickyStyle(G,S,u[A],A===p),i[A]&&this._addStickyStyle(G,F,f[A],A===I)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:p===-1?[]:c.slice(0,p+1).map((V,A)=>t[A]?V:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:I===-1?[]:c.slice(I).map((V,A)=>i[A+I]?V:null).reverse()}))})}stickRows(e,t,i){this._isBrowser&&this._coalescedStyleScheduler.schedule(()=>{let r=i==="bottom"?e.slice().reverse():e,s=i==="bottom"?t.slice().reverse():t,a=[],c=[],u=[];for(let p=0,I=0;p<r.length;p++){if(!s[p])continue;a[p]=I;let E=r[p];u[p]=this._isNativeHtmlTable?Array.from(E.children):[E];let S=E.getBoundingClientRect().height;I+=S,c[p]=S}let f=s.lastIndexOf(!0);for(let p=0;p<r.length;p++){if(!s[p])continue;let I=a[p],E=p===f;for(let S of u[p])this._addStickyStyle(S,i,I,E)}i==="top"?this._positionListener?.stickyHeaderRowsUpdated({sizes:c,offsets:a,elements:u}):this._positionListener?.stickyFooterRowsUpdated({sizes:c,offsets:a,elements:u})})}updateStickyFooterContainer(e,t){this._isNativeHtmlTable&&this._coalescedStyleScheduler.schedule(()=>{let i=e.querySelector("tfoot");i&&(t.some(r=>!r)?this._removeStickyStyle(i,["bottom"]):this._addStickyStyle(i,"bottom",0,!1))})}_removeStickyStyle(e,t){for(let r of t)e.style[r]="",e.classList.remove(this._borderCellCss[r]);vd.some(r=>t.indexOf(r)===-1&&e.style[r])?e.style.zIndex=this._getCalculatedZIndex(e):(e.style.zIndex="",this._needsPositionStickyOnElement&&(e.style.position=""),e.classList.remove(this._stickCellCss))}_addStickyStyle(e,t,i,r){e.classList.add(this._stickCellCss),r&&e.classList.add(this._borderCellCss[t]),e.style[t]=`${i}px`,e.style.zIndex=this._getCalculatedZIndex(e),this._needsPositionStickyOnElement&&(e.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(e){let t={top:100,bottom:10,left:1,right:1},i=0;for(let r of vd)e.style[r]&&(i+=t[r]);return i?`${i}`:""}_getCellWidths(e,t=!0){if(!t&&this._cachedCellWidths.length)return this._cachedCellWidths;let i=[],r=e.children;for(let s=0;s<r.length;s++){let a=r[s];i.push(a.getBoundingClientRect().width)}return this._cachedCellWidths=i,i}_getStickyStartColumnPositions(e,t){let i=[],r=0;for(let s=0;s<e.length;s++)t[s]&&(i[s]=r,r+=e[s]);return i}_getStickyEndColumnPositions(e,t){let i=[],r=0;for(let s=e.length;s>0;s--)t[s]&&(i[s]=r,r+=e[s]);return i}};var jr=new Ve("CDK_SPL");var _s=(()=>{let e=class e{constructor(i,r){this.viewContainer=i,this.elementRef=r;let s=ke(Je);s._rowOutlet=this,s._outletAssigned()}};e.\u0275fac=function(r){return new(r||e)(k(gi),k(ve))},e.\u0275dir=K({type:e,selectors:[["","rowOutlet",""]],standalone:!0});let n=e;return n})(),ys=(()=>{let e=class e{constructor(i,r){this.viewContainer=i,this.elementRef=r;let s=ke(Je);s._headerRowOutlet=this,s._outletAssigned()}};e.\u0275fac=function(r){return new(r||e)(k(gi),k(ve))},e.\u0275dir=K({type:e,selectors:[["","headerRowOutlet",""]],standalone:!0});let n=e;return n})(),vs=(()=>{let e=class e{constructor(i,r){this.viewContainer=i,this.elementRef=r;let s=ke(Je);s._footerRowOutlet=this,s._outletAssigned()}};e.\u0275fac=function(r){return new(r||e)(k(gi),k(ve))},e.\u0275dir=K({type:e,selectors:[["","footerRowOutlet",""]],standalone:!0});let n=e;return n})(),xs=(()=>{let e=class e{constructor(i,r){this.viewContainer=i,this.elementRef=r;let s=ke(Je);s._noDataRowOutlet=this,s._outletAssigned()}};e.\u0275fac=function(r){return new(r||e)(k(gi),k(ve))},e.\u0275dir=K({type:e,selectors:[["","noDataRowOutlet",""]],standalone:!0});let n=e;return n})();var ws=(()=>{let e=class e{_getCellRole(){if(this._cellRoleInternal===void 0){let i=this._elementRef.nativeElement.getAttribute("role"),r=i==="grid"||i==="treegrid"?"gridcell":"cell";this._cellRoleInternal=this._isNativeHtmlTable&&r==="cell"?null:r}return this._cellRoleInternal}get trackBy(){return this._trackByFn}set trackBy(i){this._trackByFn=i}get dataSource(){return this._dataSource}set dataSource(i){this._dataSource!==i&&this._switchDataSource(i)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(i){this._multiTemplateDataRows=i,this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(i){this._fixedLayout=i,this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(i,r,s,a,c,u,f,p,I,E,S,F){this._differs=i,this._changeDetectorRef=r,this._elementRef=s,this._dir=c,this._platform=f,this._viewRepeater=p,this._coalescedStyleScheduler=I,this._viewportRuler=E,this._stickyPositioningListener=S,this._ngZone=F,this._onDestroy=new Ge,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._hasAllOutlets=!1,this._hasInitialized=!1,this._cellRoleInternal=void 0,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new vn,this.viewChange=new Nc({start:0,end:Number.MAX_VALUE}),a||s.nativeElement.setAttribute("role","table"),this._document=u,this._isServer=!f.isBrowser,this._isNativeHtmlTable=s.nativeElement.nodeName==="TABLE"}ngOnInit(){this._setupStickyStyler(),this._dataDiffer=this._differs.find([]).create((i,r)=>this.trackBy?this.trackBy(r.dataIndex,r.data):r),this._viewportRuler.change().pipe(pi(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentInit(){this._hasInitialized=!0}ngAfterContentChecked(){this._canRender()&&this._render()}ngOnDestroy(){[this._rowOutlet?.viewContainer,this._headerRowOutlet?.viewContainer,this._footerRowOutlet?.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(i=>{i?.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),Cr(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();let i=this._dataDiffer.diff(this._renderRows);if(!i){this._updateNoDataRow(),this.contentChanged.next();return}let r=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(i,r,(s,a,c)=>this._getEmbeddedViewArgs(s.item,c),s=>s.item.data,s=>{s.operation===Gc.INSERTED&&s.context&&this._renderCellTemplateForItem(s.record.item.rowDef,s.context)}),this._updateRowIndexContext(),i.forEachIdentityChange(s=>{let a=r.get(s.currentIndex);a.context.$implicit=s.item.data}),this._updateNoDataRow(),this._ngZone&&Be.isInAngularZone()?this._ngZone.onStable.pipe(Kt(1),pi(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(i){this._customColumnDefs.add(i)}removeColumnDef(i){this._customColumnDefs.delete(i)}addRowDef(i){this._customRowDefs.add(i)}removeRowDef(i){this._customRowDefs.delete(i)}addHeaderRowDef(i){this._customHeaderRowDefs.add(i),this._headerRowDefChanged=!0}removeHeaderRowDef(i){this._customHeaderRowDefs.delete(i),this._headerRowDefChanged=!0}addFooterRowDef(i){this._customFooterRowDefs.add(i),this._footerRowDefChanged=!0}removeFooterRowDef(i){this._customFooterRowDefs.delete(i),this._footerRowDefChanged=!0}setNoDataRow(i){this._customNoDataRow=i}updateStickyHeaderRowStyles(){let i=this._getRenderedRows(this._headerRowOutlet);if(this._isNativeHtmlTable){let s=xd(this._headerRowOutlet,"thead");s&&(s.style.display=i.length?"":"none")}let r=this._headerRowDefs.map(s=>s.sticky);this._stickyStyler.clearStickyPositioning(i,["top"]),this._stickyStyler.stickRows(i,r,"top"),this._headerRowDefs.forEach(s=>s.resetStickyChanged())}updateStickyFooterRowStyles(){let i=this._getRenderedRows(this._footerRowOutlet);if(this._isNativeHtmlTable){let s=xd(this._footerRowOutlet,"tfoot");s&&(s.style.display=i.length?"":"none")}let r=this._footerRowDefs.map(s=>s.sticky);this._stickyStyler.clearStickyPositioning(i,["bottom"]),this._stickyStyler.stickRows(i,r,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,r),this._footerRowDefs.forEach(s=>s.resetStickyChanged())}updateStickyColumnStyles(){let i=this._getRenderedRows(this._headerRowOutlet),r=this._getRenderedRows(this._rowOutlet),s=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...i,...r,...s],["left","right"]),this._stickyColumnStylesNeedReset=!1),i.forEach((a,c)=>{this._addStickyColumnStyles([a],this._headerRowDefs[c])}),this._rowDefs.forEach(a=>{let c=[];for(let u=0;u<r.length;u++)this._renderRows[u].rowDef===a&&c.push(r[u]);this._addStickyColumnStyles(c,a)}),s.forEach((a,c)=>{this._addStickyColumnStyles([a],this._footerRowDefs[c])}),Array.from(this._columnDefsByName.values()).forEach(a=>a.resetStickyChanged())}_outletAssigned(){!this._hasAllOutlets&&this._rowOutlet&&this._headerRowOutlet&&this._footerRowOutlet&&this._noDataRowOutlet&&(this._hasAllOutlets=!0,this._canRender()&&this._render())}_canRender(){return this._hasAllOutlets&&this._hasInitialized}_render(){this._cacheRowDefs(),this._cacheColumnDefs(),!this._headerRowDefs.length&&!this._footerRowDefs.length&&this._rowDefs.length;let r=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||r,this._forceRecalculateCellWidths=r,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}_getAllRenderRows(){let i=[],r=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let s=0;s<this._data.length;s++){let a=this._data[s],c=this._getRenderRowsForData(a,s,r.get(a));this._cachedRenderRowsMap.has(a)||this._cachedRenderRowsMap.set(a,new WeakMap);for(let u=0;u<c.length;u++){let f=c[u],p=this._cachedRenderRowsMap.get(f.data);p.has(f.rowDef)?p.get(f.rowDef).push(f):p.set(f.rowDef,[f]),i.push(f)}}return i}_getRenderRowsForData(i,r,s){return this._getRowDefs(i,r).map(c=>{let u=s&&s.has(c)?s.get(c):[];if(u.length){let f=u.shift();return f.dataIndex=r,f}else return{data:i,rowDef:c,dataIndex:r}})}_cacheColumnDefs(){this._columnDefsByName.clear(),Or(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(r=>{this._columnDefsByName.has(r.name),this._columnDefsByName.set(r.name,r)})}_cacheRowDefs(){this._headerRowDefs=Or(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=Or(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=Or(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);let i=this._rowDefs.filter(r=>!r.when);!this.multiTemplateDataRows&&i.length>1,this._defaultRowDef=i[0]}_renderUpdatedColumns(){let i=(c,u)=>c||!!u.getColumnsDiff(),r=this._rowDefs.reduce(i,!1);r&&this._forceRenderDataRows();let s=this._headerRowDefs.reduce(i,!1);s&&this._forceRenderHeaderRows();let a=this._footerRowDefs.reduce(i,!1);return a&&this._forceRenderFooterRows(),r||s||a}_switchDataSource(i){this._data=[],Cr(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),i||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet&&this._rowOutlet.viewContainer.clear()),this._dataSource=i}_observeRenderChanges(){if(!this.dataSource)return;let i;Cr(this.dataSource)?i=this.dataSource.connect(this):Lc(this.dataSource)?i=this.dataSource:Array.isArray(this.dataSource)&&(i=_n(this.dataSource)),this._renderChangeSubscription=i.pipe(pi(this._onDestroy)).subscribe(r=>{this._data=r||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((i,r)=>this._renderRow(this._headerRowOutlet,i,r)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((i,r)=>this._renderRow(this._footerRowOutlet,i,r)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(i,r){let s=Array.from(r.columns||[]).map(u=>{let f=this._columnDefsByName.get(u);return f}),a=s.map(u=>u.sticky),c=s.map(u=>u.stickyEnd);this._stickyStyler.updateStickyColumns(i,a,c,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(i){let r=[];for(let s=0;s<i.viewContainer.length;s++){let a=i.viewContainer.get(s);r.push(a.rootNodes[0])}return r}_getRowDefs(i,r){if(this._rowDefs.length==1)return[this._rowDefs[0]];let s=[];if(this.multiTemplateDataRows)s=this._rowDefs.filter(a=>!a.when||a.when(r,i));else{let a=this._rowDefs.find(c=>c.when&&c.when(r,i))||this._defaultRowDef;a&&s.push(a)}return s.length,s}_getEmbeddedViewArgs(i,r){let s=i.rowDef,a={$implicit:i.data};return{templateRef:s.template,context:a,index:r}}_renderRow(i,r,s,a={}){let c=i.viewContainer.createEmbeddedView(r.template,a,s);return this._renderCellTemplateForItem(r,a),c}_renderCellTemplateForItem(i,r){for(let s of this._getCellTemplates(i))ei.mostRecentCellOutlet&&ei.mostRecentCellOutlet._viewContainer.createEmbeddedView(s,r);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){let i=this._rowOutlet.viewContainer;for(let r=0,s=i.length;r<s;r++){let c=i.get(r).context;c.count=s,c.first=r===0,c.last=r===s-1,c.even=r%2===0,c.odd=!c.even,this.multiTemplateDataRows?(c.dataIndex=this._renderRows[r].dataIndex,c.renderIndex=r):c.index=this._renderRows[r].dataIndex}}_getCellTemplates(i){return!i||!i.columns?[]:Array.from(i.columns,r=>{let s=this._columnDefsByName.get(r);return i.extractCellTemplate(s)})}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){let i=(r,s)=>r||s.hasStickyChanged();this._headerRowDefs.reduce(i,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(i,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(i,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){let i=this._dir?this._dir.value:"ltr";this._stickyStyler=new us(this._isNativeHtmlTable,this.stickyCssClass,i,this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:_n()).pipe(pi(this._onDestroy)).subscribe(r=>{this._stickyStyler.direction=r,this.updateStickyColumnStyles()})}_getOwnDefs(i){return i.filter(r=>!r._table||r._table===this)}_updateNoDataRow(){let i=this._customNoDataRow||this._noDataRow;if(!i)return;let r=this._rowOutlet.viewContainer.length===0;if(r===this._isShowingNoDataRow)return;let s=this._noDataRowOutlet.viewContainer;if(r){let a=s.createEmbeddedView(i.templateRef),c=a.rootNodes[0];a.rootNodes.length===1&&c?.nodeType===this._document.ELEMENT_NODE&&(c.setAttribute("role","row"),c.classList.add(i._contentClassName))}else s.clear();this._isShowingNoDataRow=r,this._changeDetectorRef.markForCheck()}};e.\u0275fac=function(r){return new(r||e)(k(xi),k(vi),k(ve),vr("role"),k(bn,8),k(Zt),k(xr),k(In),k(qr),k(Hc),k(jr,12),k(Be,8))},e.\u0275cmp=pe({type:e,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(r,s,a){if(r&1&&(Ye(a,Td,5),Ye(a,Ti,5),Ye(a,Gr,5),Ye(a,Sn,5),Ye(a,ms,5)),r&2){let c;qe(c=je())&&(s._noDataRow=c.first),qe(c=je())&&(s._contentColumnDefs=c),qe(c=je())&&(s._contentRowDefs=c),qe(c=je())&&(s._contentHeaderRowDefs=c),qe(c=je())&&(s._contentFooterRowDefs=c)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(r,s){r&2&&it("cdk-table-fixed-layout",s.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:[ie.HasDecoratorInputTransform,"multiTemplateDataRows","multiTemplateDataRows",rt],fixedLayout:[ie.HasDecoratorInputTransform,"fixedLayout","fixedLayout",rt]},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],standalone:!0,features:[Pe([{provide:Je,useExisting:e},{provide:In,useClass:Sr},{provide:qr,useClass:hs},{provide:jr,useValue:null}]),yt,ge],ngContentSelectors:wf,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(r,s){r&1&&(yi(xf),nt(0),nt(1,1),de(2,bf,1,0)(3,If,7,0)(4,Tf,4,0)),r&2&&(ce(2),Ft(2,s._isServer?2:-1),ce(),Ft(3,s._isNativeHtmlTable?3:4))},dependencies:[ys,_s,xs,vs],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2});let n=e;return n})();function Or(n,e){return n.concat(Array.from(e))}function xd(n,e){let t=e.toUpperCase(),i=n.viewContainer.element.nativeElement;for(;i;){let r=i.nodeType===1?i.nodeName:null;if(r===t)return i;if(r==="TABLE")break;i=i.parentNode}return null}var Ed=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ce({type:e}),e.\u0275inj=Ee({imports:[Wc]});let n=e;return n})();var Ef=[[["caption"]],[["colgroup"],["col"]],"*"],Cf=["caption","colgroup, col","*"];function Sf(n,e){n&1&&nt(0,2)}function Df(n,e){n&1&&(z(0,"thead",0),Oe(1,1),j(),z(2,"tbody",2),Oe(3,3)(4,4),j(),z(5,"tfoot",0),Oe(6,5),j())}function Af(n,e){n&1&&Oe(0,1)(1,3)(2,4)(3,5)}var Cd=(()=>{let e=class e extends ws{constructor(){super(...arguments),this.stickyCssClass="mat-mdc-table-sticky",this.needsPositionStickyOnElement=!1}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275cmp=pe({type:e,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(r,s){r&2&&it("mdc-table-fixed-layout",s.fixedLayout)},exportAs:["matTable"],standalone:!0,features:[Pe([{provide:ws,useExisting:e},{provide:Je,useExisting:e},{provide:qr,useClass:hs},{provide:In,useClass:Sr},{provide:jr,useValue:null}]),ne,ge],ngContentSelectors:Cf,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["role","rowgroup",1,"mdc-data-table__content"],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(r,s){r&1&&(yi(Ef),nt(0),nt(1,1),de(2,Sf,1,0)(3,Df,7,0)(4,Af,4,0)),r&2&&(ce(2),Ft(2,s._isServer?2:-1),ce(),Ft(3,s._isNativeHtmlTable?3:4))},dependencies:[ys,_s,xs,vs],styles:[".mat-mdc-table-sticky{position:sticky !important}.mdc-data-table{-webkit-overflow-scrolling:touch;display:inline-flex;flex-direction:column;box-sizing:border-box;position:relative}.mdc-data-table__table-container{-webkit-overflow-scrolling:touch;overflow-x:auto;width:100%}.mdc-data-table__table{min-width:100%;border:0;white-space:nowrap;border-spacing:0;table-layout:fixed}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell,.mdc-data-table__cell[dir=rtl]{text-align:right}.mdc-data-table__cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__cell--numeric,.mdc-data-table__cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__header-cell{box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mdc-data-table__header-cell,.mdc-data-table__header-cell[dir=rtl]{text-align:right}.mdc-data-table__header-cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__header-cell--numeric,.mdc-data-table__header-cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__header-cell-wrapper{align-items:center;display:inline-flex;vertical-align:middle}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px 0 16px}.mdc-data-table__header-cell--checkbox,.mdc-data-table__cell--checkbox{padding-left:4px;padding-right:0}[dir=rtl] .mdc-data-table__header-cell--checkbox,[dir=rtl] .mdc-data-table__cell--checkbox,.mdc-data-table__header-cell--checkbox[dir=rtl],.mdc-data-table__cell--checkbox[dir=rtl]{padding-left:0;padding-right:4px}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table{table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color)}.mat-mdc-header-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-header-headline-font, Roboto, sans-serif);line-height:var(--mat-table-header-headline-line-height);font-size:var(--mat-table-header-headline-size, 14px);font-weight:var(--mat-table-header-headline-weight, 500)}.mat-mdc-row{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87))}.mat-mdc-row,.mdc-data-table__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, Roboto, sans-serif);line-height:var(--mat-table-row-item-label-text-line-height);font-size:var(--mat-table-row-item-label-text-size, 14px);font-weight:var(--mat-table-row-item-label-text-weight)}.mat-mdc-footer-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-footer-supporting-text-font, Roboto, sans-serif);line-height:var(--mat-table-footer-supporting-text-line-height);font-size:var(--mat-table-footer-supporting-text-size, 14px);font-weight:var(--mat-table-footer-supporting-text-weight);letter-spacing:var(--mat-table-footer-supporting-text-tracking)}.mat-mdc-header-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking);font-weight:inherit;line-height:inherit}.mat-mdc-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking);line-height:inherit}.mdc-data-table__row:last-child .mat-mdc-cell{border-bottom:none}.mat-mdc-footer-cell{letter-spacing:var(--mat-table-row-item-label-text-tracking)}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2});let n=e;return n})(),Sd=(()=>{let e=class e extends zr{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["","matCellDef",""]],standalone:!0,features:[Pe([{provide:zr,useExisting:e}]),ne]});let n=e;return n})(),Dd=(()=>{let e=class e extends Ur{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["","matHeaderCellDef",""]],standalone:!0,features:[Pe([{provide:Ur,useExisting:e}]),ne]});let n=e;return n})();var Ad=(()=>{let e=class e extends Ti{get name(){return this._name}set name(i){this._setNameInput(i)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["","matColumnDef",""]],inputs:{name:[ie.None,"matColumnDef","name"]},standalone:!0,features:[Pe([{provide:Ti,useExisting:e},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:e}]),ne]});let n=e;return n})(),Rd=(()=>{let e=class e extends bd{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],standalone:!0,features:[ne]});let n=e;return n})();var kd=(()=>{let e=class e extends Id{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],standalone:!0,features:[ne]});let n=e;return n})();var Pd=(()=>{let e=class e extends Sn{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["","matHeaderRowDef",""]],inputs:{columns:[ie.None,"matHeaderRowDef","columns"],sticky:[ie.HasDecoratorInputTransform,"matHeaderRowDefSticky","sticky",rt]},standalone:!0,features:[Pe([{provide:Sn,useExisting:e}]),yt,ne]});let n=e;return n})();var Fd=(()=>{let e=class e extends Gr{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["","matRowDef",""]],inputs:{columns:[ie.None,"matRowDefColumns","columns"],when:[ie.None,"matRowDefWhen","when"]},standalone:!0,features:[Pe([{provide:Gr,useExisting:e}]),ne]});let n=e;return n})(),Md=(()=>{let e=class e extends ps{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275cmp=pe({type:e,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],standalone:!0,features:[Pe([{provide:ps,useExisting:e}]),ne,ge],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(r,s){r&1&&Oe(0,0)},dependencies:[ei],encapsulation:2});let n=e;return n})();var Vd=(()=>{let e=class e extends gs{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275cmp=pe({type:e,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],standalone:!0,features:[Pe([{provide:gs,useExisting:e}]),ne,ge],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(r,s){r&1&&Oe(0,0)},dependencies:[ei],encapsulation:2});let n=e;return n})();var Nd=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ce({type:e}),e.\u0275inj=Ee({imports:[Fe,Ed,Fe]});let n=e;return n})();var Od=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=K({type:e,selectors:[["mat-label"]],standalone:!0});let n=e;return n})();var wt=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ce({type:e}),e.\u0275inj=Ee({imports:[Fe,Mt,zc,Fe]});let n=e;return n})();var Of=new Ve("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let n=ke(Xe);return()=>n.scrollStrategies.reposition()}});function Lf(n){return()=>n.scrollStrategies.reposition()}var Bf={provide:Of,deps:[Xe],useFactory:Lf};var Ld=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ce({type:e}),e.\u0275inj=Ee({providers:[Bf],imports:[Mt,bi,ls,Fe,$c,wt,ls,Fe]});let n=e;return n})();var Bd=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ce({type:e}),e.\u0275inj=Ee({});let n=e;return n})();var qd=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ce({type:e}),e.\u0275inj=Ee({imports:[Fe,wt,wt,Bd,Fe]});let n=e;return n})();function zf(n,e){}var ti=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}};var Ts=(()=>{let e=class e extends Qc{constructor(i,r,s,a,c,u,f,p){super(),this._elementRef=i,this._focusTrapFactory=r,this._config=a,this._interactivityChecker=c,this._ngZone=u,this._overlayRef=f,this._focusMonitor=p,this._platform=ke(xr),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=ke(vi),this.attachDomPortal=I=>{this._portalOutlet.hasAttached();let E=this._portalOutlet.attachDomPortal(I);return this._contentAttached(),E},this._document=s,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(i){this._ariaLabelledByQueue.push(i),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(i){let r=this._ariaLabelledByQueue.indexOf(i);r>-1&&(this._ariaLabelledByQueue.splice(r,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(i){this._portalOutlet.hasAttached();let r=this._portalOutlet.attachComponentPortal(i);return this._contentAttached(),r}attachTemplatePortal(i){this._portalOutlet.hasAttached();let r=this._portalOutlet.attachTemplatePortal(i);return this._contentAttached(),r}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(i,r){this._interactivityChecker.isFocusable(i)||(i.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let s=()=>{i.removeEventListener("blur",s),i.removeEventListener("mousedown",s),i.removeAttribute("tabindex")};i.addEventListener("blur",s),i.addEventListener("mousedown",s)})),i.focus(r)}_focusByCssSelector(i,r){let s=this._elementRef.nativeElement.querySelector(i);s&&this._forceFocus(s,r)}_trapFocus(){let i=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||i.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElementWhenReady().then(r=>{r||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus);break}}_restoreFocus(){let i=this._config.restoreFocus,r=null;if(typeof i=="string"?r=this._document.querySelector(i):typeof i=="boolean"?r=i?this._elementFocusedBeforeDialogWasOpened:null:i&&(r=i),this._config.restoreFocus&&r&&typeof r.focus=="function"){let s=wr(),a=this._elementRef.nativeElement;(!s||s===this._document.body||s===a||a.contains(s))&&(this._focusMonitor?(this._focusMonitor.focusVia(r,this._closeInteractionType),this._closeInteractionType=null):r.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){let i=this._elementRef.nativeElement,r=wr();return i===r||i.contains(r)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=wr()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}};e.\u0275fac=function(r){return new(r||e)(k(ve),k(Tr),k(Zt,8),k(ti),k(Ir),k(Be),k(wi),k(Er))},e.\u0275cmp=pe({type:e,selectors:[["cdk-dialog-container"]],viewQuery:function(r,s){if(r&1&&wn(Tn,7),r&2){let a;qe(a=je())&&(s._portalOutlet=a.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(r,s){r&2&&$t("id",s._config.id||null)("role",s._config.role)("aria-modal",s._config.ariaModal)("aria-labelledby",s._config.ariaLabel?null:s._ariaLabelledByQueue[0])("aria-label",s._config.ariaLabel)("aria-describedby",s._config.ariaDescribedBy||null)},standalone:!0,features:[ne,ge],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(r,s){r&1&&de(0,zf,0,0,"ng-template",0)},dependencies:[Tn],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2});let n=e;return n})(),Dn=class{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new Ge,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(i=>{i.keyCode===27&&!this.disableClose&&!br(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{t.closeOnOverlayDetachments!==!1&&this.close()})}close(e,t){if(this.containerInstance){let i=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(e),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}},Uf=new Ve("DialogScrollStrategy",{providedIn:"root",factory:()=>{let n=ke(Xe);return()=>n.scrollStrategies.block()}}),Gf=new Ve("DialogData"),Kf=new Ve("DefaultDialogConfig");var Qf=0,Es=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(i,r,s,a,c,u){this._overlay=i,this._injector=r,this._defaultOptions=s,this._parentDialog=a,this._overlayContainer=c,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Ge,this._afterOpenedAtThisLevel=new Ge,this._ariaHiddenElements=new Map,this.afterAllClosed=_r(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(yr(void 0))),this._scrollStrategy=u}open(i,r){let s=this._defaultOptions||new ti;r=He(He({},s),r),r.id=r.id||`cdk-dialog-${Qf++}`,r.id&&this.getDialogById(r.id);let a=this._getOverlayConfig(r),c=this._overlay.create(a),u=new Dn(c,r),f=this._attachContainer(c,u,r);return u.containerInstance=f,this._attachDialogContent(i,u,f,r),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(u),u.closed.subscribe(()=>this._removeOpenDialog(u,!0)),this.afterOpened.next(u),u}closeAll(){bs(this.openDialogs,i=>i.close())}getDialogById(i){return this.openDialogs.find(r=>r.id===i)}ngOnDestroy(){bs(this._openDialogsAtThisLevel,i=>{i.config.closeOnDestroy===!1&&this._removeOpenDialog(i,!1)}),bs(this._openDialogsAtThisLevel,i=>i.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(i){let r=new nd({positionStrategy:i.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:i.scrollStrategy||this._scrollStrategy(),panelClass:i.panelClass,hasBackdrop:i.hasBackdrop,direction:i.direction,minWidth:i.minWidth,minHeight:i.minHeight,maxWidth:i.maxWidth,maxHeight:i.maxHeight,width:i.width,height:i.height,disposeOnNavigation:i.closeOnNavigation});return i.backdropClass&&(r.backdropClass=i.backdropClass),r}_attachContainer(i,r,s){let a=s.injector||s.viewContainerRef?.injector,c=[{provide:ti,useValue:s},{provide:Dn,useValue:r},{provide:wi,useValue:i}],u;s.container?typeof s.container=="function"?u=s.container:(u=s.container.type,c.push(...s.container.providers(s))):u=Ts;let f=new cs(u,s.viewContainerRef,Ht.create({parent:a||this._injector,providers:c}),s.componentFactoryResolver);return i.attach(f).instance}_attachDialogContent(i,r,s,a){if(i instanceof $e){let c=this._createInjector(a,r,s,void 0),u={$implicit:a.data,dialogRef:r};a.templateContext&&(u=He(He({},u),typeof a.templateContext=="function"?a.templateContext():a.templateContext)),s.attachTemplatePortal(new Kc(i,null,u,c))}else{let c=this._createInjector(a,r,s,this._injector),u=s.attachComponentPortal(new cs(i,a.viewContainerRef,c,a.componentFactoryResolver));r.componentRef=u,r.componentInstance=u.instance}}_createInjector(i,r,s,a){let c=i.injector||i.viewContainerRef?.injector,u=[{provide:Gf,useValue:i.data},{provide:Dn,useValue:r}];return i.providers&&(typeof i.providers=="function"?u.push(...i.providers(r,i,s)):u.push(...i.providers)),i.direction&&(!c||!c.get(bn,null,{optional:!0}))&&u.push({provide:bn,useValue:{value:i.direction,change:_n()}}),Ht.create({parent:c||a,providers:u})}_removeOpenDialog(i,r){let s=this.openDialogs.indexOf(i);s>-1&&(this.openDialogs.splice(s,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((a,c)=>{a?c.setAttribute("aria-hidden",a):c.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),r&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){let i=this._overlayContainer.getContainerElement();if(i.parentElement){let r=i.parentElement.children;for(let s=r.length-1;s>-1;s--){let a=r[s];a!==i&&a.nodeName!=="SCRIPT"&&a.nodeName!=="STYLE"&&!a.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(a,a.getAttribute("aria-hidden")),a.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){let i=this._parentDialog;return i?i._getAfterAllClosed():this._afterAllClosedAtThisLevel}};e.\u0275fac=function(r){return new(r||e)(fe(Xe),fe(Ht),fe(Kf,8),fe(e,12),fe(kr),fe(Uf))},e.\u0275prov=_t({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function bs(n,e){let t=n.length;for(;t--;)e(n[t])}var jd=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ce({type:e}),e.\u0275inj=Ee({providers:[Es],imports:[bi,En,Uc,En]});let n=e;return n})();function $f(n,e){}var An=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}},Cs="mdc-dialog--open",zd="mdc-dialog--opening",Ud="mdc-dialog--closing",Wf=150,Yf=75,Xf=(()=>{let e=class e extends Ts{constructor(i,r,s,a,c,u,f,p,I){super(i,r,s,a,c,u,f,I),this._animationMode=p,this._animationStateChanged=new vn,this._animationsEnabled=this._animationMode!=="NoopAnimations",this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?Kd(this._config.enterAnimationDuration)??Wf:0,this._exitAnimationDuration=this._animationsEnabled?Kd(this._config.exitAnimationDuration)??Yf:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(Gd,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(zd,Cs)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(Cs),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(Cs),this._animationsEnabled?(this._hostElement.style.setProperty(Gd,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(Ud)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(i){this._actionSectionCount+=i,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(zd,Ud)}_waitForAnimationToComplete(i,r){this._animationTimer!==null&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(r,i)}_requestAnimationFrame(i){this._ngZone.runOutsideAngular(()=>{typeof requestAnimationFrame=="function"?requestAnimationFrame(i):i()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(i){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:i})}ngOnDestroy(){super.ngOnDestroy(),this._animationTimer!==null&&clearTimeout(this._animationTimer)}attachComponentPortal(i){let r=super.attachComponentPortal(i);return r.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),r}};e.\u0275fac=function(r){return new(r||e)(k(ve),k(Tr),k(Zt,8),k(An),k(Ir),k(Be),k(wi),k(ss,8),k(Er))},e.\u0275cmp=pe({type:e,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(r,s){r&2&&(xn("id",s._config.id),$t("aria-modal",s._config.ariaModal)("role",s._config.role)("aria-labelledby",s._config.ariaLabel?null:s._ariaLabelledByQueue[0])("aria-label",s._config.ariaLabel)("aria-describedby",s._config.ariaDescribedBy||null),it("_mat-animation-noopable",!s._animationsEnabled)("mat-mdc-dialog-container-with-actions",s._actionSectionCount>0))},standalone:!0,features:[ne,ge],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(r,s){r&1&&(z(0,"div",0)(1,"div",1),de(2,$f,0,0,"ng-template",2),j()())},dependencies:[Tn],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto;outline:0;transform:scale(0.8)}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--closing .mdc-dialog__surface{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{opacity:1}.mdc-dialog--open .mdc-dialog__surface{transform:none}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__container .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{width:100%;height:100%}.mat-mdc-dialog-component-host{display:contents}.mat-mdc-dialog-container{--mdc-dialog-container-elevation: var(--mdc-dialog-container-elevation-shadow);outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, 4px)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87))}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6))}.mat-mdc-dialog-container .mdc-dialog__container{transition:opacity linear var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container .mdc-dialog__surface{transition:transform var(--mat-dialog-transition-duration, 0ms) 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container,.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__surface{transition:none}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-title{padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2});let n=e;return n})(),Gd="--mat-dialog-transition-duration";function Kd(n){return n==null?null:typeof n=="number"?n:n.endsWith("ms")?as(n.substring(0,n.length-2)):n.endsWith("s")?as(n.substring(0,n.length-1))*1e3:n==="0"?0:null}var Kr=function(n){return n[n.OPEN=0]="OPEN",n[n.CLOSING=1]="CLOSING",n[n.CLOSED=2]="CLOSED",n}(Kr||{}),Ei=class{constructor(e,t,i){this._ref=e,this._containerInstance=i,this._afterOpened=new Ge,this._beforeClosed=new Ge,this._state=Kr.OPEN,this.disableClose=t.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),i._animationStateChanged.pipe(yn(r=>r.state==="opened"),Kt(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(yn(r=>r.state==="closed"),Kt(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),Bc(this.backdropClick(),this.keydownEvents().pipe(yn(r=>r.keyCode===27&&!this.disableClose&&!br(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),Jf(this,r.type==="keydown"?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(yn(t=>t.state==="closing"),Kt(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=Kr.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=Kr.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}};function Jf(n,e,t){return n._closeInteractionType=e,n.close(t)}var Ss=new Ve("MatMdcDialogData"),Zf=new Ve("mat-mdc-dialog-default-options"),em=new Ve("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{let n=ke(Xe);return()=>n.scrollStrategies.block()}});var tm=0,Qr=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){let i=this._parentDialog;return i?i._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(i,r,s,a,c,u,f,p){this._overlay=i,this._defaultOptions=a,this._scrollStrategy=c,this._parentDialog=u,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Ge,this._afterOpenedAtThisLevel=new Ge,this.dialogConfigClass=An,this.afterAllClosed=_r(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(yr(void 0))),this._dialog=r.get(Es),this._dialogRefConstructor=Ei,this._dialogContainerType=Xf,this._dialogDataToken=Ss}open(i,r){let s;r=He(He({},this._defaultOptions||new An),r),r.id=r.id||`mat-mdc-dialog-${tm++}`,r.scrollStrategy=r.scrollStrategy||this._scrollStrategy();let a=this._dialog.open(i,gr(He({},r),{positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:r},{provide:ti,useValue:r}]},templateContext:()=>({dialogRef:s}),providers:(c,u,f)=>(s=new this._dialogRefConstructor(c,r,f),s.updatePosition(r?.position),[{provide:this._dialogContainerType,useValue:f},{provide:this._dialogDataToken,useValue:u.data},{provide:this._dialogRefConstructor,useValue:s}])}));return s.componentRef=a.componentRef,s.componentInstance=a.componentInstance,this.openDialogs.push(s),this.afterOpened.next(s),s.afterClosed().subscribe(()=>{let c=this.openDialogs.indexOf(s);c>-1&&(this.openDialogs.splice(c,1),this.openDialogs.length||this._getAfterAllClosed().next())}),s}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(i){return this.openDialogs.find(r=>r.id===i)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(i){let r=i.length;for(;r--;)i[r].close()}};e.\u0275fac=function(r){return new(r||e)(fe(Xe),fe(Ht),fe(qc,8),fe(Zf,8),fe(em),fe(e,12),fe(kr),fe(ss,8))},e.\u0275prov=_t({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),im=0;var Qd=(()=>{let e=class e{constructor(i,r,s){this._dialogRef=i,this._elementRef=r,this._dialog=s}ngOnInit(){this._dialogRef||(this._dialogRef=nm(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{this._onAdd()})}ngOnDestroy(){this._dialogRef?._containerInstance&&Promise.resolve().then(()=>{this._onRemove()})}};e.\u0275fac=function(r){return new(r||e)(k(Ei,8),k(ve),k(Qr))},e.\u0275dir=K({type:e,standalone:!0});let n=e;return n})(),Hd=(()=>{let e=class e extends Qd{constructor(){super(...arguments),this.id=`mat-mdc-dialog-title-${im++}`}_onAdd(){this._dialogRef._containerInstance?._addAriaLabelledBy?.(this.id)}_onRemove(){this._dialogRef?._containerInstance?._removeAriaLabelledBy?.(this.id)}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-mdc-dialog-title","mdc-dialog__title"],hostVars:1,hostBindings:function(r,s){r&2&&xn("id",s.id)},inputs:{id:"id"},exportAs:["matDialogTitle"],standalone:!0,features:[ne]});let n=e;return n})(),$d=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=K({type:e,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-mdc-dialog-content","mdc-dialog__content"],standalone:!0});let n=e;return n})(),Wd=(()=>{let e=class e extends Qd{_onAdd(){this._dialogRef._containerInstance?._updateActionSectionCount?.(1)}_onRemove(){this._dialogRef._containerInstance?._updateActionSectionCount?.(-1)}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=Ne(e)))(s||e)}})(),e.\u0275dir=K({type:e,selectors:[["","mat-dialog-actions",""],["mat-dialog-actions"],["","matDialogActions",""]],hostAttrs:[1,"mat-mdc-dialog-actions","mdc-dialog__actions"],hostVars:6,hostBindings:function(r,s){r&2&&it("mat-mdc-dialog-actions-align-start",s.align==="start")("mat-mdc-dialog-actions-align-center",s.align==="center")("mat-mdc-dialog-actions-align-end",s.align==="end")},inputs:{align:"align"},standalone:!0,features:[ne]});let n=e;return n})();function nm(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-mdc-dialog-container");)t=t.parentElement;return t?e.find(i=>i.id===t.id):null}var Yd=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ce({type:e}),e.\u0275inj=Ee({providers:[Qr],imports:[jd,bi,En,Fe,Fe]});let n=e;return n})();var Xd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Jd={};var Vt,Ds;(function(){var n;function e(x,m){function _(){}_.prototype=m.prototype,x.D=m.prototype,x.prototype=new _,x.prototype.constructor=x,x.C=function(y,v,b){for(var g=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)g[mt-2]=arguments[mt];return m.prototype[v].apply(y,g)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(x,m,_){_||(_=0);var y=Array(16);if(typeof m=="string")for(var v=0;16>v;++v)y[v]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(v=0;16>v;++v)y[v]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=x.g[0],_=x.g[1],v=x.g[2];var b=x.g[3],g=m+(b^_&(v^b))+y[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=b+(v^m&(_^v))+y[1]+3905402710&4294967295,b=m+(g<<12&4294967295|g>>>20),g=v+(_^b&(m^_))+y[2]+606105819&4294967295,v=b+(g<<17&4294967295|g>>>15),g=_+(m^v&(b^m))+y[3]+3250441966&4294967295,_=v+(g<<22&4294967295|g>>>10),g=m+(b^_&(v^b))+y[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(v^m&(_^v))+y[5]+1200080426&4294967295,b=m+(g<<12&4294967295|g>>>20),g=v+(_^b&(m^_))+y[6]+2821735955&4294967295,v=b+(g<<17&4294967295|g>>>15),g=_+(m^v&(b^m))+y[7]+4249261313&4294967295,_=v+(g<<22&4294967295|g>>>10),g=m+(b^_&(v^b))+y[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(v^m&(_^v))+y[9]+2336552879&4294967295,b=m+(g<<12&4294967295|g>>>20),g=v+(_^b&(m^_))+y[10]+4294925233&4294967295,v=b+(g<<17&4294967295|g>>>15),g=_+(m^v&(b^m))+y[11]+2304563134&4294967295,_=v+(g<<22&4294967295|g>>>10),g=m+(b^_&(v^b))+y[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(v^m&(_^v))+y[13]+4254626195&4294967295,b=m+(g<<12&4294967295|g>>>20),g=v+(_^b&(m^_))+y[14]+2792965006&4294967295,v=b+(g<<17&4294967295|g>>>15),g=_+(m^v&(b^m))+y[15]+1236535329&4294967295,_=v+(g<<22&4294967295|g>>>10),g=m+(v^b&(_^v))+y[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^v&(m^_))+y[6]+3225465664&4294967295,b=m+(g<<9&4294967295|g>>>23),g=v+(m^_&(b^m))+y[11]+643717713&4294967295,v=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(v^b))+y[0]+3921069994&4294967295,_=v+(g<<20&4294967295|g>>>12),g=m+(v^b&(_^v))+y[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^v&(m^_))+y[10]+38016083&4294967295,b=m+(g<<9&4294967295|g>>>23),g=v+(m^_&(b^m))+y[15]+3634488961&4294967295,v=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(v^b))+y[4]+3889429448&4294967295,_=v+(g<<20&4294967295|g>>>12),g=m+(v^b&(_^v))+y[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^v&(m^_))+y[14]+3275163606&4294967295,b=m+(g<<9&4294967295|g>>>23),g=v+(m^_&(b^m))+y[3]+4107603335&4294967295,v=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(v^b))+y[8]+1163531501&4294967295,_=v+(g<<20&4294967295|g>>>12),g=m+(v^b&(_^v))+y[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^v&(m^_))+y[2]+4243563512&4294967295,b=m+(g<<9&4294967295|g>>>23),g=v+(m^_&(b^m))+y[7]+1735328473&4294967295,v=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(v^b))+y[12]+2368359562&4294967295,_=v+(g<<20&4294967295|g>>>12),g=m+(_^v^b)+y[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^v)+y[8]+2272392833&4294967295,b=m+(g<<11&4294967295|g>>>21),g=v+(b^m^_)+y[11]+1839030562&4294967295,v=b+(g<<16&4294967295|g>>>16),g=_+(v^b^m)+y[14]+4259657740&4294967295,_=v+(g<<23&4294967295|g>>>9),g=m+(_^v^b)+y[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^v)+y[4]+1272893353&4294967295,b=m+(g<<11&4294967295|g>>>21),g=v+(b^m^_)+y[7]+4139469664&4294967295,v=b+(g<<16&4294967295|g>>>16),g=_+(v^b^m)+y[10]+3200236656&4294967295,_=v+(g<<23&4294967295|g>>>9),g=m+(_^v^b)+y[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^v)+y[0]+3936430074&4294967295,b=m+(g<<11&4294967295|g>>>21),g=v+(b^m^_)+y[3]+3572445317&4294967295,v=b+(g<<16&4294967295|g>>>16),g=_+(v^b^m)+y[6]+76029189&4294967295,_=v+(g<<23&4294967295|g>>>9),g=m+(_^v^b)+y[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^v)+y[12]+3873151461&4294967295,b=m+(g<<11&4294967295|g>>>21),g=v+(b^m^_)+y[15]+530742520&4294967295,v=b+(g<<16&4294967295|g>>>16),g=_+(v^b^m)+y[2]+3299628645&4294967295,_=v+(g<<23&4294967295|g>>>9),g=m+(v^(_|~b))+y[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~v))+y[7]+1126891415&4294967295,b=m+(g<<10&4294967295|g>>>22),g=v+(m^(b|~_))+y[14]+2878612391&4294967295,v=b+(g<<15&4294967295|g>>>17),g=_+(b^(v|~m))+y[5]+4237533241&4294967295,_=v+(g<<21&4294967295|g>>>11),g=m+(v^(_|~b))+y[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~v))+y[3]+2399980690&4294967295,b=m+(g<<10&4294967295|g>>>22),g=v+(m^(b|~_))+y[10]+4293915773&4294967295,v=b+(g<<15&4294967295|g>>>17),g=_+(b^(v|~m))+y[1]+2240044497&4294967295,_=v+(g<<21&4294967295|g>>>11),g=m+(v^(_|~b))+y[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~v))+y[15]+4264355552&4294967295,b=m+(g<<10&4294967295|g>>>22),g=v+(m^(b|~_))+y[6]+2734768916&4294967295,v=b+(g<<15&4294967295|g>>>17),g=_+(b^(v|~m))+y[13]+1309151649&4294967295,_=v+(g<<21&4294967295|g>>>11),g=m+(v^(_|~b))+y[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~v))+y[11]+3174756917&4294967295,b=m+(g<<10&4294967295|g>>>22),g=v+(m^(b|~_))+y[2]+718787259&4294967295,v=b+(g<<15&4294967295|g>>>17),g=_+(b^(v|~m))+y[9]+3951481745&4294967295,x.g[0]=x.g[0]+m&4294967295,x.g[1]=x.g[1]+(v+(g<<21&4294967295|g>>>11))&4294967295,x.g[2]=x.g[2]+v&4294967295,x.g[3]=x.g[3]+b&4294967295}i.prototype.u=function(x,m){m===void 0&&(m=x.length);for(var _=m-this.blockSize,y=this.B,v=this.h,b=0;b<m;){if(v==0)for(;b<=_;)r(this,x,b),b+=this.blockSize;if(typeof x=="string"){for(;b<m;)if(y[v++]=x.charCodeAt(b++),v==this.blockSize){r(this,y),v=0;break}}else for(;b<m;)if(y[v++]=x[b++],v==this.blockSize){r(this,y),v=0;break}}this.h=v,this.o+=m},i.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var m=1;m<x.length-8;++m)x[m]=0;var _=8*this.o;for(m=x.length-8;m<x.length;++m)x[m]=_&255,_/=256;for(this.u(x),x=Array(16),m=_=0;4>m;++m)for(var y=0;32>y;y+=8)x[_++]=this.g[m]>>>y&255;return x};function s(x,m){var _=c;return Object.prototype.hasOwnProperty.call(_,x)?_[x]:_[x]=m(x)}function a(x,m){this.h=m;for(var _=[],y=!0,v=x.length-1;0<=v;v--){var b=x[v]|0;y&&b==m||(_[v]=b,y=!1)}this.g=_}var c={};function u(x){return-128<=x&&128>x?s(x,function(m){return new a([m|0],0>m?-1:0)}):new a([x|0],0>x?-1:0)}function f(x){if(isNaN(x)||!isFinite(x))return I;if(0>x)return A(f(-x));for(var m=[],_=1,y=0;x>=_;y++)m[y]=x/_|0,_*=4294967296;return new a(m,0)}function p(x,m){if(x.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(x.charAt(0)=="-")return A(p(x.substring(1),m));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=f(Math.pow(m,8)),y=I,v=0;v<x.length;v+=8){var b=Math.min(8,x.length-v),g=parseInt(x.substring(v,v+b),m);8>b?(b=f(Math.pow(m,b)),y=y.j(b).add(f(g))):(y=y.j(_),y=y.add(f(g)))}return y}var I=u(0),E=u(1),S=u(16777216);n=a.prototype,n.m=function(){if(V(this))return-A(this).m();for(var x=0,m=1,_=0;_<this.g.length;_++){var y=this.i(_);x+=(0<=y?y:4294967296+y)*m,m*=4294967296}return x},n.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(F(this))return"0";if(V(this))return"-"+A(this).toString(x);for(var m=f(Math.pow(x,6)),_=this,y="";;){var v=re(_,m).g;_=G(_,v.j(m));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(x);if(_=v,F(_))return b+y;for(;6>b.length;)b="0"+b;y=b+y}},n.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function F(x){if(x.h!=0)return!1;for(var m=0;m<x.g.length;m++)if(x.g[m]!=0)return!1;return!0}function V(x){return x.h==-1}n.l=function(x){return x=G(this,x),V(x)?-1:F(x)?0:1};function A(x){for(var m=x.g.length,_=[],y=0;y<m;y++)_[y]=~x.g[y];return new a(_,~x.h).add(E)}n.abs=function(){return V(this)?A(this):this},n.add=function(x){for(var m=Math.max(this.g.length,x.g.length),_=[],y=0,v=0;v<=m;v++){var b=y+(this.i(v)&65535)+(x.i(v)&65535),g=(b>>>16)+(this.i(v)>>>16)+(x.i(v)>>>16);y=g>>>16,b&=65535,g&=65535,_[v]=g<<16|b}return new a(_,_[_.length-1]&-2147483648?-1:0)};function G(x,m){return x.add(A(m))}n.j=function(x){if(F(this)||F(x))return I;if(V(this))return V(x)?A(this).j(A(x)):A(A(this).j(x));if(V(x))return A(this.j(A(x)));if(0>this.l(S)&&0>x.l(S))return f(this.m()*x.m());for(var m=this.g.length+x.g.length,_=[],y=0;y<2*m;y++)_[y]=0;for(y=0;y<this.g.length;y++)for(var v=0;v<x.g.length;v++){var b=this.i(y)>>>16,g=this.i(y)&65535,mt=x.i(v)>>>16,Xi=x.i(v)&65535;_[2*y+2*v]+=g*Xi,H(_,2*y+2*v),_[2*y+2*v+1]+=b*Xi,H(_,2*y+2*v+1),_[2*y+2*v+1]+=g*mt,H(_,2*y+2*v+1),_[2*y+2*v+2]+=b*mt,H(_,2*y+2*v+2)}for(y=0;y<m;y++)_[y]=_[2*y+1]<<16|_[2*y];for(y=m;y<2*m;y++)_[y]=0;return new a(_,0)};function H(x,m){for(;(x[m]&65535)!=x[m];)x[m+1]+=x[m]>>>16,x[m]&=65535,m++}function Y(x,m){this.g=x,this.h=m}function re(x,m){if(F(m))throw Error("division by zero");if(F(x))return new Y(I,I);if(V(x))return m=re(A(x),m),new Y(A(m.g),A(m.h));if(V(m))return m=re(x,A(m)),new Y(A(m.g),m.h);if(30<x.g.length){if(V(x)||V(m))throw Error("slowDivide_ only works with positive integers.");for(var _=E,y=m;0>=y.l(x);)_=Ue(_),y=Ue(y);var v=ee(_,1),b=ee(y,1);for(y=ee(y,2),_=ee(_,2);!F(y);){var g=b.add(y);0>=g.l(x)&&(v=v.add(_),b=g),y=ee(y,1),_=ee(_,1)}return m=G(x,v.j(m)),new Y(v,m)}for(v=I;0<=x.l(m);){for(_=Math.max(1,Math.floor(x.m()/m.m())),y=Math.ceil(Math.log(_)/Math.LN2),y=48>=y?1:Math.pow(2,y-48),b=f(_),g=b.j(m);V(g)||0<g.l(x);)_-=y,b=f(_),g=b.j(m);F(b)&&(b=E),v=v.add(b),x=G(x,g)}return new Y(v,x)}n.A=function(x){return re(this,x).h},n.and=function(x){for(var m=Math.max(this.g.length,x.g.length),_=[],y=0;y<m;y++)_[y]=this.i(y)&x.i(y);return new a(_,this.h&x.h)},n.or=function(x){for(var m=Math.max(this.g.length,x.g.length),_=[],y=0;y<m;y++)_[y]=this.i(y)|x.i(y);return new a(_,this.h|x.h)},n.xor=function(x){for(var m=Math.max(this.g.length,x.g.length),_=[],y=0;y<m;y++)_[y]=this.i(y)^x.i(y);return new a(_,this.h^x.h)};function Ue(x){for(var m=x.g.length+1,_=[],y=0;y<m;y++)_[y]=x.i(y)<<1|x.i(y-1)>>>31;return new a(_,x.h)}function ee(x,m){var _=m>>5;m%=32;for(var y=x.g.length-_,v=[],b=0;b<y;b++)v[b]=0<m?x.i(b+_)>>>m|x.i(b+_+1)<<32-m:x.i(b+_);return new a(v,x.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,Ds=Jd.Md5=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=f,a.fromString=p,Vt=Jd.Integer=a}).apply(typeof Xd<"u"?Xd:typeof self<"u"?self:typeof window<"u"?window:{});var Hr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},bt={};var As,Rs,Ci,ks,Rn,$r,Ps,Fs,Ms;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,l,d){return o==Array.prototype||o==Object.prototype||(o[l]=d.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hr=="object"&&Hr];for(var l=0;l<o.length;++l){var d=o[l];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var i=t(this);function r(o,l){if(l)e:{var d=i;o=o.split(".");for(var h=0;h<o.length-1;h++){var w=o[h];if(!(w in d))break e;d=d[w]}o=o[o.length-1],h=d[o],l=l(h),l!=h&&l!=null&&e(d,o,{configurable:!0,writable:!0,value:l})}}function s(o,l){o instanceof String&&(o+="");var d=0,h=!1,w={next:function(){if(!h&&d<o.length){var T=d++;return{value:l(T,o[T]),done:!1}}return h=!0,{done:!0,value:void 0}}};return w[Symbol.iterator]=function(){return w},w}r("Array.prototype.values",function(o){return o||function(){return s(this,function(l,d){return d})}});var a=a||{},c=this||self;function u(o){var l=typeof o;return l=l!="object"?l:o?Array.isArray(o)?"array":l:"null",l=="array"||l=="object"&&typeof o.length=="number"}function f(o){var l=typeof o;return l=="object"&&o!=null||l=="function"}function p(o,l,d){return o.call.apply(o.bind,arguments)}function I(o,l,d){if(!o)throw Error();if(2<arguments.length){var h=Array.prototype.slice.call(arguments,2);return function(){var w=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(w,h),o.apply(l,w)}}return function(){return o.apply(l,arguments)}}function E(o,l,d){return E=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:I,E.apply(null,arguments)}function S(o,l){var d=Array.prototype.slice.call(arguments,1);return function(){var h=d.slice();return h.push.apply(h,arguments),o.apply(this,h)}}function F(o,l){function d(){}d.prototype=l.prototype,o.aa=l.prototype,o.prototype=new d,o.prototype.constructor=o,o.Qb=function(h,w,T){for(var R=Array(arguments.length-2),X=2;X<arguments.length;X++)R[X-2]=arguments[X];return l.prototype[w].apply(h,R)}}function V(o){let l=o.length;if(0<l){let d=Array(l);for(let h=0;h<l;h++)d[h]=o[h];return d}return[]}function A(o,l){for(let d=1;d<arguments.length;d++){let h=arguments[d];if(u(h)){let w=o.length||0,T=h.length||0;o.length=w+T;for(let R=0;R<T;R++)o[w+R]=h[R]}else o.push(h)}}class G{constructor(l,d){this.i=l,this.j=d,this.h=0,this.g=null}get(){let l;return 0<this.h?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function H(o){return/^[\s\xa0]*$/.test(o)}function Y(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function re(o){return re[" "](o),o}re[" "]=function(){};var Ue=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function ee(o,l,d){for(let h in o)l.call(d,o[h],h,o)}function x(o,l){for(let d in o)l.call(void 0,o[d],d,o)}function m(o){let l={};for(let d in o)l[d]=o[d];return l}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function y(o,l){let d,h;for(let w=1;w<arguments.length;w++){h=arguments[w];for(d in h)o[d]=h[d];for(let T=0;T<_.length;T++)d=_[T],Object.prototype.hasOwnProperty.call(h,d)&&(o[d]=h[d])}}function v(o){var l=1;o=o.split(":");let d=[];for(;0<l&&o.length;)d.push(o.shift()),l--;return o.length&&d.push(o.join(":")),d}function b(o){c.setTimeout(()=>{throw o},0)}function g(){var o=Vo;let l=null;return o.g&&(l=o.g,o.g=o.g.next,o.g||(o.h=null),l.next=null),l}class mt{constructor(){this.h=this.g=null}add(l,d){let h=Xi.get();h.set(l,d),this.h?this.h.next=h:this.g=h,this.h=h}}var Xi=new G(()=>new Oh,o=>o.reset());class Oh{constructor(){this.next=this.g=this.h=null}set(l,d){this.h=l,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Ji,Zi=!1,Vo=new mt,Vl=()=>{let o=c.Promise.resolve(void 0);Ji=()=>{o.then(Lh)}};var Lh=()=>{for(var o;o=g();){try{o.h.call(o.g)}catch(d){b(d)}var l=Xi;l.j(o),100>l.h&&(l.h++,o.next=l.g,l.g=o)}Zi=!1};function St(){this.s=this.s,this.C=this.C}St.prototype.s=!1,St.prototype.ma=function(){this.s||(this.s=!0,this.N())},St.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function we(o,l){this.type=o,this.g=this.target=l,this.defaultPrevented=!1}we.prototype.h=function(){this.defaultPrevented=!0};var Bh=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,l=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let d=()=>{};c.addEventListener("test",d,l),c.removeEventListener("test",d,l)}catch{}return o}();function en(o,l){if(we.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var d=this.type=o.type,h=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=l,l=o.relatedTarget){if(Ue){e:{try{re(l.nodeName);var w=!0;break e}catch{}w=!1}w||(l=null)}}else d=="mouseover"?l=o.fromElement:d=="mouseout"&&(l=o.toElement);this.relatedTarget=l,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:qh[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&en.aa.h.call(this)}}F(en,we);var qh={2:"touch",3:"pen",4:"mouse"};en.prototype.h=function(){en.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var tn="closure_listenable_"+(1e6*Math.random()|0),jh=0;function zh(o,l,d,h,w){this.listener=o,this.proxy=null,this.src=l,this.type=d,this.capture=!!h,this.ha=w,this.key=++jh,this.da=this.fa=!1}function Zn(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function er(o){this.src=o,this.g={},this.h=0}er.prototype.add=function(o,l,d,h,w){var T=o.toString();o=this.g[T],o||(o=this.g[T]=[],this.h++);var R=Oo(o,l,h,w);return-1<R?(l=o[R],d||(l.fa=!1)):(l=new zh(l,this.src,T,!!h,w),l.fa=d,o.push(l)),l};function No(o,l){var d=l.type;if(d in o.g){var h=o.g[d],w=Array.prototype.indexOf.call(h,l,void 0),T;(T=0<=w)&&Array.prototype.splice.call(h,w,1),T&&(Zn(l),o.g[d].length==0&&(delete o.g[d],o.h--))}}function Oo(o,l,d,h){for(var w=0;w<o.length;++w){var T=o[w];if(!T.da&&T.listener==l&&T.capture==!!d&&T.ha==h)return w}return-1}var Lo="closure_lm_"+(1e6*Math.random()|0),Bo={};function Nl(o,l,d,h,w){if(h&&h.once)return Ll(o,l,d,h,w);if(Array.isArray(l)){for(var T=0;T<l.length;T++)Nl(o,l[T],d,h,w);return null}return d=Uo(d),o&&o[tn]?o.K(l,d,f(h)?!!h.capture:!!h,w):Ol(o,l,d,!1,h,w)}function Ol(o,l,d,h,w,T){if(!l)throw Error("Invalid event type");var R=f(w)?!!w.capture:!!w,X=jo(o);if(X||(o[Lo]=X=new er(o)),d=X.add(l,d,h,R,T),d.proxy)return d;if(h=Uh(),d.proxy=h,h.src=o,h.listener=d,o.addEventListener)Bh||(w=R),w===void 0&&(w=!1),o.addEventListener(l.toString(),h,w);else if(o.attachEvent)o.attachEvent(ql(l.toString()),h);else if(o.addListener&&o.removeListener)o.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return d}function Uh(){function o(d){return l.call(o.src,o.listener,d)}let l=Gh;return o}function Ll(o,l,d,h,w){if(Array.isArray(l)){for(var T=0;T<l.length;T++)Ll(o,l[T],d,h,w);return null}return d=Uo(d),o&&o[tn]?o.L(l,d,f(h)?!!h.capture:!!h,w):Ol(o,l,d,!0,h,w)}function Bl(o,l,d,h,w){if(Array.isArray(l))for(var T=0;T<l.length;T++)Bl(o,l[T],d,h,w);else h=f(h)?!!h.capture:!!h,d=Uo(d),o&&o[tn]?(o=o.i,l=String(l).toString(),l in o.g&&(T=o.g[l],d=Oo(T,d,h,w),-1<d&&(Zn(T[d]),Array.prototype.splice.call(T,d,1),T.length==0&&(delete o.g[l],o.h--)))):o&&(o=jo(o))&&(l=o.g[l.toString()],o=-1,l&&(o=Oo(l,d,h,w)),(d=-1<o?l[o]:null)&&qo(d))}function qo(o){if(typeof o!="number"&&o&&!o.da){var l=o.src;if(l&&l[tn])No(l.i,o);else{var d=o.type,h=o.proxy;l.removeEventListener?l.removeEventListener(d,h,o.capture):l.detachEvent?l.detachEvent(ql(d),h):l.addListener&&l.removeListener&&l.removeListener(h),(d=jo(l))?(No(d,o),d.h==0&&(d.src=null,l[Lo]=null)):Zn(o)}}}function ql(o){return o in Bo?Bo[o]:Bo[o]="on"+o}function Gh(o,l){if(o.da)o=!0;else{l=new en(l,this);var d=o.listener,h=o.ha||o.src;o.fa&&qo(o),o=d.call(h,l)}return o}function jo(o){return o=o[Lo],o instanceof er?o:null}var zo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Uo(o){return typeof o=="function"?o:(o[zo]||(o[zo]=function(l){return o.handleEvent(l)}),o[zo])}function be(){St.call(this),this.i=new er(this),this.M=this,this.F=null}F(be,St),be.prototype[tn]=!0,be.prototype.removeEventListener=function(o,l,d,h){Bl(this,o,l,d,h)};function Ae(o,l){var d,h=o.F;if(h)for(d=[];h;h=h.F)d.push(h);if(o=o.M,h=l.type||l,typeof l=="string")l=new we(l,o);else if(l instanceof we)l.target=l.target||o;else{var w=l;l=new we(h,o),y(l,w)}if(w=!0,d)for(var T=d.length-1;0<=T;T--){var R=l.g=d[T];w=tr(R,h,!0,l)&&w}if(R=l.g=o,w=tr(R,h,!0,l)&&w,w=tr(R,h,!1,l)&&w,d)for(T=0;T<d.length;T++)R=l.g=d[T],w=tr(R,h,!1,l)&&w}be.prototype.N=function(){if(be.aa.N.call(this),this.i){var o=this.i,l;for(l in o.g){for(var d=o.g[l],h=0;h<d.length;h++)Zn(d[h]);delete o.g[l],o.h--}}this.F=null},be.prototype.K=function(o,l,d,h){return this.i.add(String(o),l,!1,d,h)},be.prototype.L=function(o,l,d,h){return this.i.add(String(o),l,!0,d,h)};function tr(o,l,d,h){if(l=o.i.g[String(l)],!l)return!0;l=l.concat();for(var w=!0,T=0;T<l.length;++T){var R=l[T];if(R&&!R.da&&R.capture==d){var X=R.listener,ye=R.ha||R.src;R.fa&&No(o.i,R),w=X.call(ye,h)!==!1&&w}}return w&&!h.defaultPrevented}function jl(o,l,d){if(typeof o=="function")d&&(o=E(o,d));else if(o&&typeof o.handleEvent=="function")o=E(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(l)?-1:c.setTimeout(o,l||0)}function zl(o){o.g=jl(()=>{o.g=null,o.i&&(o.i=!1,zl(o))},o.l);let l=o.h;o.h=null,o.m.apply(null,l)}class Kh extends St{constructor(l,d){super(),this.m=l,this.l=d,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:zl(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nn(o){St.call(this),this.h=o,this.g={}}F(nn,St);var Ul=[];function Gl(o){ee(o.g,function(l,d){this.g.hasOwnProperty(d)&&qo(l)},o),o.g={}}nn.prototype.N=function(){nn.aa.N.call(this),Gl(this)},nn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Go=c.JSON.stringify,Qh=c.JSON.parse,Hh=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function Ko(){}Ko.prototype.h=null;function Kl(o){return o.h||(o.h=o.i())}function Ql(){}var rn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Qo(){we.call(this,"d")}F(Qo,we);function Ho(){we.call(this,"c")}F(Ho,we);var jt={},Hl=null;function ir(){return Hl=Hl||new be}jt.La="serverreachability";function $l(o){we.call(this,jt.La,o)}F($l,we);function on(o){let l=ir();Ae(l,new $l(l))}jt.STAT_EVENT="statevent";function Wl(o,l){we.call(this,jt.STAT_EVENT,o),this.stat=l}F(Wl,we);function Re(o){let l=ir();Ae(l,new Wl(l,o))}jt.Ma="timingevent";function Yl(o,l){we.call(this,jt.Ma,o),this.size=l}F(Yl,we);function sn(o,l){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},l)}function an(){this.g=!0}an.prototype.xa=function(){this.g=!1};function $h(o,l,d,h,w,T){o.info(function(){if(o.g)if(T)for(var R="",X=T.split("&"),ye=0;ye<X.length;ye++){var $=X[ye].split("=");if(1<$.length){var Ie=$[0];$=$[1];var Te=Ie.split("_");R=2<=Te.length&&Te[1]=="type"?R+(Ie+"="+$+"&"):R+(Ie+"=redacted&")}}else R=null;else R=T;return"XMLHTTP REQ ("+h+") [attempt "+w+"]: "+l+`
`+d+`
`+R})}function Wh(o,l,d,h,w,T,R){o.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+w+"]: "+l+`
`+d+`
`+T+" "+R})}function ui(o,l,d,h){o.info(function(){return"XMLHTTP TEXT ("+l+"): "+Xh(o,d)+(h?" "+h:"")})}function Yh(o,l){o.info(function(){return"TIMEOUT: "+l})}an.prototype.info=function(){};function Xh(o,l){if(!o.g)return l;if(!l)return null;try{var d=JSON.parse(l);if(d){for(o=0;o<d.length;o++)if(Array.isArray(d[o])){var h=d[o];if(!(2>h.length)){var w=h[1];if(Array.isArray(w)&&!(1>w.length)){var T=w[0];if(T!="noop"&&T!="stop"&&T!="close")for(var R=1;R<w.length;R++)w[R]=""}}}}return Go(d)}catch{return l}}var nr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Xl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},$o;function rr(){}F(rr,Ko),rr.prototype.g=function(){return new XMLHttpRequest},rr.prototype.i=function(){return{}},$o=new rr;function Dt(o,l,d,h){this.j=o,this.i=l,this.l=d,this.R=h||1,this.U=new nn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Jl}function Jl(){this.i=null,this.g="",this.h=!1}var Zl={},Wo={};function Yo(o,l,d){o.L=1,o.v=lr(pt(l)),o.m=d,o.P=!0,ec(o,null)}function ec(o,l){o.F=Date.now(),or(o),o.A=pt(o.v);var d=o.A,h=o.R;Array.isArray(h)||(h=[String(h)]),mc(d.i,"t",h),o.C=0,d=o.j.J,o.h=new Jl,o.g=Pc(o.j,d?l:null,!o.m),0<o.O&&(o.M=new Kh(E(o.Y,o,o.g),o.O)),l=o.U,d=o.g,h=o.ca;var w="readystatechange";Array.isArray(w)||(w&&(Ul[0]=w.toString()),w=Ul);for(var T=0;T<w.length;T++){var R=Nl(d,w[T],h||l.handleEvent,!1,l.h||l);if(!R)break;l.g[R.key]=R}l=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),l["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,l)):(o.u="GET",o.g.ea(o.A,o.u,null,l)),on(),$h(o.i,o.u,o.A,o.l,o.R,o.m)}Dt.prototype.ca=function(o){o=o.target;let l=this.M;l&&gt(o)==3?l.j():this.Y(o)},Dt.prototype.Y=function(o){try{if(o==this.g)e:{let Te=gt(this.g);var l=this.g.Ba();let mi=this.g.Z();if(!(3>Te)&&(Te!=3||this.g&&(this.h.h||this.g.oa()||wc(this.g)))){this.J||Te!=4||l==7||(l==8||0>=mi?on(3):on(2)),Xo(this);var d=this.g.Z();this.X=d;t:if(tc(this)){var h=wc(this.g);o="";var w=h.length,T=gt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){zt(this),ln(this);var R="";break t}this.h.i=new c.TextDecoder}for(l=0;l<w;l++)this.h.h=!0,o+=this.h.i.decode(h[l],{stream:!(T&&l==w-1)});h.length=0,this.h.g+=o,this.C=0,R=this.h.g}else R=this.g.oa();if(this.o=d==200,Wh(this.i,this.u,this.A,this.l,this.R,Te,d),this.o){if(this.T&&!this.K){t:{if(this.g){var X,ye=this.g;if((X=ye.g?ye.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(X)){var $=X;break t}}$=null}if(d=$)ui(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Jo(this,d);else{this.o=!1,this.s=3,Re(12),zt(this),ln(this);break e}}if(this.P){d=!0;let Qe;for(;!this.J&&this.C<R.length;)if(Qe=Jh(this,R),Qe==Wo){Te==4&&(this.s=4,Re(14),d=!1),ui(this.i,this.l,null,"[Incomplete Response]");break}else if(Qe==Zl){this.s=4,Re(15),ui(this.i,this.l,R,"[Invalid Chunk]"),d=!1;break}else ui(this.i,this.l,Qe,null),Jo(this,Qe);if(tc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Te!=4||R.length!=0||this.h.h||(this.s=1,Re(16),d=!1),this.o=this.o&&d,!d)ui(this.i,this.l,R,"[Invalid Chunked Response]"),zt(this),ln(this);else if(0<R.length&&!this.W){this.W=!0;var Ie=this.j;Ie.g==this&&Ie.ba&&!Ie.M&&(Ie.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),rs(Ie),Ie.M=!0,Re(11))}}else ui(this.i,this.l,R,null),Jo(this,R);Te==4&&zt(this),this.o&&!this.J&&(Te==4?Dc(this.j,this):(this.o=!1,or(this)))}else gf(this.g),d==400&&0<R.indexOf("Unknown SID")?(this.s=3,Re(12)):(this.s=0,Re(13)),zt(this),ln(this)}}}catch{}finally{}};function tc(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Jh(o,l){var d=o.C,h=l.indexOf(`
`,d);return h==-1?Wo:(d=Number(l.substring(d,h)),isNaN(d)?Zl:(h+=1,h+d>l.length?Wo:(l=l.slice(h,h+d),o.C=h+d,l)))}Dt.prototype.cancel=function(){this.J=!0,zt(this)};function or(o){o.S=Date.now()+o.I,ic(o,o.I)}function ic(o,l){if(o.B!=null)throw Error("WatchDog timer not null");o.B=sn(E(o.ba,o),l)}function Xo(o){o.B&&(c.clearTimeout(o.B),o.B=null)}Dt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(Yh(this.i,this.A),this.L!=2&&(on(),Re(17)),zt(this),this.s=2,ln(this)):ic(this,this.S-o)};function ln(o){o.j.G==0||o.J||Dc(o.j,o)}function zt(o){Xo(o);var l=o.M;l&&typeof l.ma=="function"&&l.ma(),o.M=null,Gl(o.U),o.g&&(l=o.g,o.g=null,l.abort(),l.ma())}function Jo(o,l){try{var d=o.j;if(d.G!=0&&(d.g==o||Zo(d.h,o))){if(!o.K&&Zo(d.h,o)&&d.G==3){try{var h=d.Da.g.parse(l)}catch{h=null}if(Array.isArray(h)&&h.length==3){var w=h;if(w[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<o.F)fr(d),ur(d);else break e;ns(d),Re(18)}}else d.za=w[1],0<d.za-d.T&&37500>w[2]&&d.F&&d.v==0&&!d.C&&(d.C=sn(E(d.Za,d),6e3));if(1>=oc(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else Gt(d,11)}else if((o.K||d.g==o)&&fr(d),!H(l))for(w=d.Da.g.parse(l),l=0;l<w.length;l++){let $=w[l];if(d.T=$[0],$=$[1],d.G==2)if($[0]=="c"){d.K=$[1],d.ia=$[2];let Ie=$[3];Ie!=null&&(d.la=Ie,d.j.info("VER="+d.la));let Te=$[4];Te!=null&&(d.Aa=Te,d.j.info("SVER="+d.Aa));let mi=$[5];mi!=null&&typeof mi=="number"&&0<mi&&(h=1.5*mi,d.L=h,d.j.info("backChannelRequestTimeoutMs_="+h)),h=d;let Qe=o.g;if(Qe){let pr=Qe.g?Qe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pr){var T=h.h;T.g||pr.indexOf("spdy")==-1&&pr.indexOf("quic")==-1&&pr.indexOf("h2")==-1||(T.j=T.l,T.g=new Set,T.h&&(es(T,T.h),T.h=null))}if(h.D){let os=Qe.g?Qe.g.getResponseHeader("X-HTTP-Session-Id"):null;os&&(h.ya=os,te(h.I,h.D,os))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-o.F,d.j.info("Handshake RTT: "+d.R+"ms")),h=d;var R=o;if(h.qa=kc(h,h.J?h.ia:null,h.W),R.K){sc(h.h,R);var X=R,ye=h.L;ye&&(X.I=ye),X.B&&(Xo(X),or(X)),h.g=R}else Cc(h);0<d.i.length&&hr(d)}else $[0]!="stop"&&$[0]!="close"||Gt(d,7);else d.G==3&&($[0]=="stop"||$[0]=="close"?$[0]=="stop"?Gt(d,7):is(d):$[0]!="noop"&&d.l&&d.l.ta($),d.v=0)}}on(4)}catch{}}var Zh=class{constructor(o,l){this.g=o,this.map=l}};function nc(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function rc(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function oc(o){return o.h?1:o.g?o.g.size:0}function Zo(o,l){return o.h?o.h==l:o.g?o.g.has(l):!1}function es(o,l){o.g?o.g.add(l):o.h=l}function sc(o,l){o.h&&o.h==l?o.h=null:o.g&&o.g.has(l)&&o.g.delete(l)}nc.prototype.cancel=function(){if(this.i=ac(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function ac(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let l=o.i;for(let d of o.g.values())l=l.concat(d.D);return l}return V(o.i)}function ef(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var l=[],d=o.length,h=0;h<d;h++)l.push(o[h]);return l}l=[],d=0;for(h in o)l[d++]=o[h];return l}function tf(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var l=[];o=o.length;for(var d=0;d<o;d++)l.push(d);return l}l=[],d=0;for(let h in o)l[d++]=h;return l}}}function lc(o,l){if(o.forEach&&typeof o.forEach=="function")o.forEach(l,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,l,void 0);else for(var d=tf(o),h=ef(o),w=h.length,T=0;T<w;T++)l.call(void 0,h[T],d&&d[T],o)}var cc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nf(o,l){if(o){o=o.split("&");for(var d=0;d<o.length;d++){var h=o[d].indexOf("="),w=null;if(0<=h){var T=o[d].substring(0,h);w=o[d].substring(h+1)}else T=o[d];l(T,w?decodeURIComponent(w.replace(/\+/g," ")):"")}}}function Ut(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Ut){this.h=o.h,sr(this,o.j),this.o=o.o,this.g=o.g,ar(this,o.s),this.l=o.l;var l=o.i,d=new un;d.i=l.i,l.g&&(d.g=new Map(l.g),d.h=l.h),dc(this,d),this.m=o.m}else o&&(l=String(o).match(cc))?(this.h=!1,sr(this,l[1]||"",!0),this.o=cn(l[2]||""),this.g=cn(l[3]||"",!0),ar(this,l[4]),this.l=cn(l[5]||"",!0),dc(this,l[6]||"",!0),this.m=cn(l[7]||"")):(this.h=!1,this.i=new un(null,this.h))}Ut.prototype.toString=function(){var o=[],l=this.j;l&&o.push(dn(l,uc,!0),":");var d=this.g;return(d||l=="file")&&(o.push("//"),(l=this.o)&&o.push(dn(l,uc,!0),"@"),o.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&o.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&o.push("/"),o.push(dn(d,d.charAt(0)=="/"?sf:of,!0))),(d=this.i.toString())&&o.push("?",d),(d=this.m)&&o.push("#",dn(d,lf)),o.join("")};function pt(o){return new Ut(o)}function sr(o,l,d){o.j=d?cn(l,!0):l,o.j&&(o.j=o.j.replace(/:$/,""))}function ar(o,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);o.s=l}else o.s=null}function dc(o,l,d){l instanceof un?(o.i=l,cf(o.i,o.h)):(d||(l=dn(l,af)),o.i=new un(l,o.h))}function te(o,l,d){o.i.set(l,d)}function lr(o){return te(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function cn(o,l){return o?l?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function dn(o,l,d){return typeof o=="string"?(o=encodeURI(o).replace(l,rf),d&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function rf(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var uc=/[#\/\?@]/g,of=/[#\?:]/g,sf=/[#\?]/g,af=/[#\?@]/g,lf=/#/g;function un(o,l){this.h=this.g=null,this.i=o||null,this.j=!!l}function At(o){o.g||(o.g=new Map,o.h=0,o.i&&nf(o.i,function(l,d){o.add(decodeURIComponent(l.replace(/\+/g," ")),d)}))}n=un.prototype,n.add=function(o,l){At(this),this.i=null,o=hi(this,o);var d=this.g.get(o);return d||this.g.set(o,d=[]),d.push(l),this.h+=1,this};function hc(o,l){At(o),l=hi(o,l),o.g.has(l)&&(o.i=null,o.h-=o.g.get(l).length,o.g.delete(l))}function fc(o,l){return At(o),l=hi(o,l),o.g.has(l)}n.forEach=function(o,l){At(this),this.g.forEach(function(d,h){d.forEach(function(w){o.call(l,w,h,this)},this)},this)},n.na=function(){At(this);let o=Array.from(this.g.values()),l=Array.from(this.g.keys()),d=[];for(let h=0;h<l.length;h++){let w=o[h];for(let T=0;T<w.length;T++)d.push(l[h])}return d},n.V=function(o){At(this);let l=[];if(typeof o=="string")fc(this,o)&&(l=l.concat(this.g.get(hi(this,o))));else{o=Array.from(this.g.values());for(let d=0;d<o.length;d++)l=l.concat(o[d])}return l},n.set=function(o,l){return At(this),this.i=null,o=hi(this,o),fc(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[l]),this.h+=1,this},n.get=function(o,l){return o?(o=this.V(o),0<o.length?String(o[0]):l):l};function mc(o,l,d){hc(o,l),0<d.length&&(o.i=null,o.g.set(hi(o,l),V(d)),o.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],l=Array.from(this.g.keys());for(var d=0;d<l.length;d++){var h=l[d];let T=encodeURIComponent(String(h)),R=this.V(h);for(h=0;h<R.length;h++){var w=T;R[h]!==""&&(w+="="+encodeURIComponent(String(R[h]))),o.push(w)}}return this.i=o.join("&")};function hi(o,l){return l=String(l),o.j&&(l=l.toLowerCase()),l}function cf(o,l){l&&!o.j&&(At(o),o.i=null,o.g.forEach(function(d,h){var w=h.toLowerCase();h!=w&&(hc(this,h),mc(this,w,d))},o)),o.j=l}function df(o,l){let d=new an;if(c.Image){let h=new Image;h.onload=S(Rt,d,"TestLoadImage: loaded",!0,l,h),h.onerror=S(Rt,d,"TestLoadImage: error",!1,l,h),h.onabort=S(Rt,d,"TestLoadImage: abort",!1,l,h),h.ontimeout=S(Rt,d,"TestLoadImage: timeout",!1,l,h),c.setTimeout(function(){h.ontimeout&&h.ontimeout()},1e4),h.src=o}else l(!1)}function uf(o,l){let d=new an,h=new AbortController,w=setTimeout(()=>{h.abort(),Rt(d,"TestPingServer: timeout",!1,l)},1e4);fetch(o,{signal:h.signal}).then(T=>{clearTimeout(w),T.ok?Rt(d,"TestPingServer: ok",!0,l):Rt(d,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(w),Rt(d,"TestPingServer: error",!1,l)})}function Rt(o,l,d,h,w){try{w&&(w.onload=null,w.onerror=null,w.onabort=null,w.ontimeout=null),h(d)}catch{}}function hf(){this.g=new Hh}function ff(o,l,d){let h=d||"";try{lc(o,function(w,T){let R=w;f(w)&&(R=Go(w)),l.push(h+T+"="+encodeURIComponent(R))})}catch(w){throw l.push(h+"type="+encodeURIComponent("_badmap")),w}}function hn(o){this.l=o.Ub||null,this.j=o.eb||!1}F(hn,Ko),hn.prototype.g=function(){return new cr(this.l,this.j)},hn.prototype.i=function(o){return function(){return o}}({});function cr(o,l){be.call(this),this.D=o,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}F(cr,be),n=cr.prototype,n.open=function(o,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=l,this.readyState=1,mn(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let l={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(l.body=o),(this.D||c).fetch(new Request(this.A,l)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,fn(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,mn(this)),this.g&&(this.readyState=3,mn(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;pc(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function pc(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var l=o.value?o.value:new Uint8Array(0);(l=this.v.decode(l,{stream:!o.done}))&&(this.response=this.responseText+=l)}o.done?fn(this):mn(this),this.readyState==3&&pc(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,fn(this))},n.Qa=function(o){this.g&&(this.response=o,fn(this))},n.ga=function(){this.g&&fn(this)};function fn(o){o.readyState=4,o.l=null,o.j=null,o.v=null,mn(o)}n.setRequestHeader=function(o,l){this.u.append(o,l)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],l=this.h.entries();for(var d=l.next();!d.done;)d=d.value,o.push(d[0]+": "+d[1]),d=l.next();return o.join(`\r
`)};function mn(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(cr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function gc(o){let l="";return ee(o,function(d,h){l+=h,l+=":",l+=d,l+=`\r
`}),l}function ts(o,l,d){e:{for(h in d){var h=!1;break e}h=!0}h||(d=gc(d),typeof o=="string"?d!=null&&encodeURIComponent(String(d)):te(o,l,d))}function oe(o){be.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}F(oe,be);var mf=/^https?$/i,pf=["POST","PUT"];n=oe.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,l,d,h){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);l=l?l.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():$o.g(),this.v=this.o?Kl(this.o):Kl($o),this.g.onreadystatechange=E(this.Ea,this);try{this.B=!0,this.g.open(l,String(o),!0),this.B=!1}catch(T){_c(this,T);return}if(o=d||"",d=new Map(this.headers),h)if(Object.getPrototypeOf(h)===Object.prototype)for(var w in h)d.set(w,h[w]);else if(typeof h.keys=="function"&&typeof h.get=="function")for(let T of h.keys())d.set(T,h.get(T));else throw Error("Unknown input type for opt_headers: "+String(h));h=Array.from(d.keys()).find(T=>T.toLowerCase()=="content-type"),w=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(pf,l,void 0))||h||w||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[T,R]of d)this.g.setRequestHeader(T,R);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xc(this),this.u=!0,this.g.send(o),this.u=!1}catch(T){_c(this,T)}};function _c(o,l){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=l,o.m=5,yc(o),dr(o)}function yc(o){o.A||(o.A=!0,Ae(o,"complete"),Ae(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ae(this,"complete"),Ae(this,"abort"),dr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),dr(this,!0)),oe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?vc(this):this.bb())},n.bb=function(){vc(this)};function vc(o){if(o.h&&typeof a<"u"&&(!o.v[1]||gt(o)!=4||o.Z()!=2)){if(o.u&&gt(o)==4)jl(o.Ea,0,o);else if(Ae(o,"readystatechange"),gt(o)==4){o.h=!1;try{let R=o.Z();e:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var d;if(!(d=l)){var h;if(h=R===0){var w=String(o.D).match(cc)[1]||null;!w&&c.self&&c.self.location&&(w=c.self.location.protocol.slice(0,-1)),h=!mf.test(w?w.toLowerCase():"")}d=h}if(d)Ae(o,"complete"),Ae(o,"success");else{o.m=6;try{var T=2<gt(o)?o.g.statusText:""}catch{T=""}o.l=T+" ["+o.Z()+"]",yc(o)}}finally{dr(o)}}}}function dr(o,l){if(o.g){xc(o);let d=o.g,h=o.v[0]?()=>{}:null;o.g=null,o.v=null,l||Ae(o,"ready");try{d.onreadystatechange=h}catch{}}}function xc(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function gt(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<gt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var l=this.g.responseText;return o&&l.indexOf(o)==0&&(l=l.substring(o.length)),Qh(l)}};function wc(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function gf(o){let l={};o=(o.g&&2<=gt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let h=0;h<o.length;h++){if(H(o[h]))continue;var d=v(o[h]);let w=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let T=l[w]||[];l[w]=T,T.push(d)}x(l,function(h){return h.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function pn(o,l,d){return d&&d.internalChannelParams&&d.internalChannelParams[o]||l}function bc(o){this.Aa=0,this.i=[],this.j=new an,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=pn("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=pn("baseRetryDelayMs",5e3,o),this.cb=pn("retryDelaySeedMs",1e4,o),this.Wa=pn("forwardChannelMaxRetries",2,o),this.wa=pn("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new nc(o&&o.concurrentRequestLimit),this.Da=new hf,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=bc.prototype,n.la=8,n.G=1,n.connect=function(o,l,d,h){Re(0),this.W=o,this.H=l||{},d&&h!==void 0&&(this.H.OSID=d,this.H.OAID=h),this.F=this.X,this.I=kc(this,null,this.W),hr(this)};function is(o){if(Ic(o),o.G==3){var l=o.U++,d=pt(o.I);if(te(d,"SID",o.K),te(d,"RID",l),te(d,"TYPE","terminate"),gn(o,d),l=new Dt(o,o.j,l),l.L=2,l.v=lr(pt(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(l.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=l.v,d=!0),d||(l.g=Pc(l.j,null),l.g.ea(l.v)),l.F=Date.now(),or(l)}Rc(o)}function ur(o){o.g&&(rs(o),o.g.cancel(),o.g=null)}function Ic(o){ur(o),o.u&&(c.clearTimeout(o.u),o.u=null),fr(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function hr(o){if(!rc(o.h)&&!o.s){o.s=!0;var l=o.Ga;Ji||Vl(),Zi||(Ji(),Zi=!0),Vo.add(l,o),o.B=0}}function _f(o,l){return oc(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=l.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=sn(E(o.Ga,o,l),Ac(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let w=new Dt(this,this.j,o),T=this.o;if(this.S&&(T?(T=m(T),y(T,this.S)):T=this.S),this.m!==null||this.O||(w.H=T,T=null),this.P)e:{for(var l=0,d=0;d<this.i.length;d++){t:{var h=this.i[d];if("__data__"in h.map&&(h=h.map.__data__,typeof h=="string")){h=h.length;break t}h=void 0}if(h===void 0)break;if(l+=h,4096<l){l=d;break e}if(l===4096||d===this.i.length-1){l=d+1;break e}}l=1e3}else l=1e3;l=Ec(this,w,l),d=pt(this.I),te(d,"RID",o),te(d,"CVER",22),this.D&&te(d,"X-HTTP-Session-Id",this.D),gn(this,d),T&&(this.O?l="headers="+encodeURIComponent(String(gc(T)))+"&"+l:this.m&&ts(d,this.m,T)),es(this.h,w),this.Ua&&te(d,"TYPE","init"),this.P?(te(d,"$req",l),te(d,"SID","null"),w.T=!0,Yo(w,d,null)):Yo(w,d,l),this.G=2}}else this.G==3&&(o?Tc(this,o):this.i.length==0||rc(this.h)||Tc(this))};function Tc(o,l){var d;l?d=l.l:d=o.U++;let h=pt(o.I);te(h,"SID",o.K),te(h,"RID",d),te(h,"AID",o.T),gn(o,h),o.m&&o.o&&ts(h,o.m,o.o),d=new Dt(o,o.j,d,o.B+1),o.m===null&&(d.H=o.o),l&&(o.i=l.D.concat(o.i)),l=Ec(o,d,1e3),d.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),es(o.h,d),Yo(d,h,l)}function gn(o,l){o.H&&ee(o.H,function(d,h){te(l,h,d)}),o.l&&lc({},function(d,h){te(l,h,d)})}function Ec(o,l,d){d=Math.min(o.i.length,d);var h=o.l?E(o.l.Na,o.l,o):null;e:{var w=o.i;let T=-1;for(;;){let R=["count="+d];T==-1?0<d?(T=w[0].g,R.push("ofs="+T)):T=0:R.push("ofs="+T);let X=!0;for(let ye=0;ye<d;ye++){let $=w[ye].g,Ie=w[ye].map;if($-=T,0>$)T=Math.max(0,w[ye].g-100),X=!1;else try{ff(Ie,R,"req"+$+"_")}catch{h&&h(Ie)}}if(X){h=R.join("&");break e}}}return o=o.i.splice(0,d),l.D=o,h}function Cc(o){if(!o.g&&!o.u){o.Y=1;var l=o.Fa;Ji||Vl(),Zi||(Ji(),Zi=!0),Vo.add(l,o),o.v=0}}function ns(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=sn(E(o.Fa,o),Ac(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,Sc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=sn(E(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Re(10),ur(this),Sc(this))};function rs(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function Sc(o){o.g=new Dt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var l=pt(o.qa);te(l,"RID","rpc"),te(l,"SID",o.K),te(l,"AID",o.T),te(l,"CI",o.F?"0":"1"),!o.F&&o.ja&&te(l,"TO",o.ja),te(l,"TYPE","xmlhttp"),gn(o,l),o.m&&o.o&&ts(l,o.m,o.o),o.L&&(o.g.I=o.L);var d=o.g;o=o.ia,d.L=1,d.v=lr(pt(l)),d.m=null,d.P=!0,ec(d,o)}n.Za=function(){this.C!=null&&(this.C=null,ur(this),ns(this),Re(19))};function fr(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function Dc(o,l){var d=null;if(o.g==l){fr(o),rs(o),o.g=null;var h=2}else if(Zo(o.h,l))d=l.D,sc(o.h,l),h=1;else return;if(o.G!=0){if(l.o)if(h==1){d=l.m?l.m.length:0,l=Date.now()-l.F;var w=o.B;h=ir(),Ae(h,new Yl(h,d)),hr(o)}else Cc(o);else if(w=l.s,w==3||w==0&&0<l.X||!(h==1&&_f(o,l)||h==2&&ns(o)))switch(d&&0<d.length&&(l=o.h,l.i=l.i.concat(d)),w){case 1:Gt(o,5);break;case 4:Gt(o,10);break;case 3:Gt(o,6);break;default:Gt(o,2)}}}function Ac(o,l){let d=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(d*=2),d*l}function Gt(o,l){if(o.j.info("Error code "+l),l==2){var d=E(o.fb,o),h=o.Xa;let w=!h;h=new Ut(h||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||sr(h,"https"),lr(h),w?df(h.toString(),d):uf(h.toString(),d)}else Re(2);o.G=0,o.l&&o.l.sa(l),Rc(o),Ic(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function Rc(o){if(o.G=0,o.ka=[],o.l){let l=ac(o.h);(l.length!=0||o.i.length!=0)&&(A(o.ka,l),A(o.ka,o.i),o.h.i.length=0,V(o.i),o.i.length=0),o.l.ra()}}function kc(o,l,d){var h=d instanceof Ut?pt(d):new Ut(d);if(h.g!="")l&&(h.g=l+"."+h.g),ar(h,h.s);else{var w=c.location;h=w.protocol,l=l?l+"."+w.hostname:w.hostname,w=+w.port;var T=new Ut(null);h&&sr(T,h),l&&(T.g=l),w&&ar(T,w),d&&(T.l=d),h=T}return d=o.D,l=o.ya,d&&l&&te(h,d,l),te(h,"VER",o.la),gn(o,h),h}function Pc(o,l,d){if(l&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return l=o.Ca&&!o.pa?new oe(new hn({eb:d})):new oe(o.pa),l.Ha(o.J),l}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fc(){}n=Fc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function mr(){}mr.prototype.g=function(o,l){return new Le(o,l)};function Le(o,l){be.call(this),this.g=new bc(l),this.l=o,this.h=l&&l.messageUrlParams||null,o=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(o?o["X-WebChannel-Content-Type"]=l.messageContentType:o={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.va&&(o?o["X-WebChannel-Client-Profile"]=l.va:o={"X-WebChannel-Client-Profile":l.va}),this.g.S=o,(o=l&&l.Sb)&&!H(o)&&(this.g.m=o),this.v=l&&l.supportsCrossDomainXhr||!1,this.u=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!H(l)&&(this.g.D=l,o=this.h,o!==null&&l in o&&(o=this.h,l in o&&delete o[l])),this.j=new fi(this)}F(Le,be),Le.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Le.prototype.close=function(){is(this.g)},Le.prototype.o=function(o){var l=this.g;if(typeof o=="string"){var d={};d.__data__=o,o=d}else this.u&&(d={},d.__data__=Go(o),o=d);l.i.push(new Zh(l.Ya++,o)),l.G==3&&hr(l)},Le.prototype.N=function(){this.g.l=null,delete this.j,is(this.g),delete this.g,Le.aa.N.call(this)};function Mc(o){Qo.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var l=o.__sm__;if(l){e:{for(let d in l){o=d;break e}o=void 0}(this.i=o)&&(o=this.i,l=l!==null&&o in l?l[o]:void 0),this.data=l}else this.data=o}F(Mc,Qo);function Vc(){Ho.call(this),this.status=1}F(Vc,Ho);function fi(o){this.g=o}F(fi,Fc),fi.prototype.ua=function(){Ae(this.g,"a")},fi.prototype.ta=function(o){Ae(this.g,new Mc(o))},fi.prototype.sa=function(o){Ae(this.g,new Vc)},fi.prototype.ra=function(){Ae(this.g,"b")},mr.prototype.createWebChannel=mr.prototype.g,Le.prototype.send=Le.prototype.o,Le.prototype.open=Le.prototype.m,Le.prototype.close=Le.prototype.close,Ms=bt.createWebChannelTransport=function(){return new mr},Fs=bt.getStatEventTarget=function(){return ir()},Ps=bt.Event=jt,$r=bt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},nr.NO_ERROR=0,nr.TIMEOUT=8,nr.HTTP_ERROR=6,Rn=bt.ErrorCode=nr,Xl.COMPLETE="complete",ks=bt.EventType=Xl,Ql.EventType=rn,rn.OPEN="a",rn.CLOSE="b",rn.ERROR="c",rn.MESSAGE="d",be.prototype.listen=be.prototype.K,Ci=bt.WebChannel=Ql,Rs=bt.FetchXmlHttpFactory=hn,oe.prototype.listenOnce=oe.prototype.L,oe.prototype.getLastError=oe.prototype.Ka,oe.prototype.getLastErrorCode=oe.prototype.Ba,oe.prototype.getStatus=oe.prototype.Z,oe.prototype.getResponseJson=oe.prototype.Oa,oe.prototype.getResponseText=oe.prototype.oa,oe.prototype.send=oe.prototype.ea,oe.prototype.setWithCredentials=oe.prototype.Ha,As=bt.XhrIo=oe}).apply(typeof Hr<"u"?Hr:typeof self<"u"?self:typeof window<"u"?window:{});var Zd="@firebase/firestore";var _e=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};_e.UNAUTHENTICATED=new _e(null),_e.GOOGLE_CREDENTIALS=new _e("google-credentials-uid"),_e.FIRST_PARTY=new _e("first-party-uid"),_e.MOCK_USER=new _e("mock-user");var $i="10.12.3";var ri=new md("@firebase/firestore");function kn(){return ri.logLevel}function M(n,...e){if(ri.logLevel<=xt.DEBUG){let t=e.map(yl);ri.debug(`Firestore (${$i}): ${n}`,...t)}}function It(n,...e){if(ri.logLevel<=xt.ERROR){let t=e.map(yl);ri.error(`Firestore (${$i}): ${n}`,...t)}}function Mi(n,...e){if(ri.logLevel<=xt.WARN){let t=e.map(yl);ri.warn(`Firestore (${$i}): ${n}`,...t)}}function yl(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function L(n="Unexpected state"){let e=`FIRESTORE (${$i}) INTERNAL ASSERTION FAILED: `+n;throw It(e),new Error(e)}function Z(n,e){n||L()}function B(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},N=class extends hd{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var lt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Zr=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Bs=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(_e.UNAUTHENTICATED))}shutdown(){}},qs=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},js=class{constructor(e){this.t=e,this.currentUser=_e.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let i=this.i,r=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve(),s=new lt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new lt,e.enqueueRetryable(()=>r(this.currentUser))};let a=()=>{let u=s;e.enqueueRetryable(()=>P(this,null,function*(){yield u.promise,yield r(this.currentUser)}))},c=u=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?c(u):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new lt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Z(typeof i.accessToken=="string"),new Zr(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string"),new _e(e)}},zs=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=_e.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Us=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new zs(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(_e.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Gs=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Ks=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let i=s=>{s.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?r(s):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Z(typeof t.token=="string"),this.R=t.token,new Gs(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function om(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var eo=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let r=om(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}};function W(n,e){return n<e?-1:n>e?1:0}function Vi(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var xe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new N(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new N(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new N(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new N(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?W(this.nanoseconds,e.nanoseconds):W(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var q=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new xe(0,0))}static max(){return new n(new xe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var to=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&L(),i===void 0?i=e.length-t:i>e.length-t&&L(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=e.get(r),a=t.get(r);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ae=class n extends to{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new N(C.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},sm=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ze=class n extends to{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return sm.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new N(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},a=!1;for(;r<e.length;){let c=e[r];if(c==="\\"){if(r+1===e.length)throw new N(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new N(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,r+=2}else c==="`"?(a=!a,r++):c!=="."||a?(i+=c,r++):(s(),r++)}if(s(),a)throw new N(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var O=class n{constructor(e){this.path=e}static fromPath(e){return new n(ae.fromString(e))}static fromName(e){return new n(ae.fromString(e).popFirst(5))}static empty(){return new n(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ae(e.slice()))}};var Qs=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};Qs.UNKNOWN_ID=-1;function am(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=q.fromTimestamp(i===1e9?new xe(t+1,0):new xe(t,i));return new oi(r,O.empty(),e)}function lm(n){return new oi(n.readTime,n.key,-1)}var oi=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(q.min(),O.empty(),-1)}static max(){return new n(q.max(),O.empty(),-1)}};function cm(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=O.comparator(n.documentKey,e.documentKey),t!==0?t:W(n.largestBatchId,e.largestBatchId))}var dm="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Hs=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Wn(n){return P(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==dm)throw n;M("LocalStore","Unexpectedly lost primary lease")})}var D=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&L(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,a=!1;e.forEach(c=>{++r,c.next(()=>{++s,a&&s===r&&t()},u=>i(u))}),a=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,a=new Array(s),c=0;for(let u=0;u<s;u++){let f=u;t(e[f]).next(p=>{a[f]=p,++c,c===s&&i(a)},p=>r(p))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};function um(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Yn(n){return n.name==="IndexedDbTransactionError"}var Su=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ie(r),this.se=r=>i.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Do(n){return n==null}function On(n){return n===0&&1/n==-1/0}function hm(n){return typeof n=="number"&&Number.isInteger(n)&&!On(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var fm=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Gy=[...fm,"documentOverlays"],mm=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],pm=mm,Ky=[...pm,"indexConfiguration","indexState","indexEntries"];function eu(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Wi(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Du(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var le=class n{constructor(e,t){this.comparator=e,this.root=t||ct.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ct.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ct.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ri(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ri(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ri(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ri(this.root,e,this.comparator,!0)}},Ri=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ct=class n{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new n(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw L();let e=this.left.check();if(e!==this.right.check())throw L();return e+(this.isRed()?0:1)}};ct.EMPTY=null,ct.RED=!0,ct.BLACK=!1;ct.EMPTY=new class{constructor(){this.size=0}get key(){throw L()}get value(){throw L()}get color(){throw L()}get left(){throw L()}get right(){throw L()}copy(e,t,i,r,s){return this}insert(e,t,i){return new ct(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var De=class n{constructor(e){this.comparator=e,this.data=new le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new io(this.data.getIterator())}getIteratorFrom(e){return new io(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},io=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var at=class n{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new n([])}unionWith(e){let t=new De(ze.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Vi(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var no=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Me=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new no("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(r){let s="";for(let a=0;a<r.length;++a)s+=String.fromCharCode(r[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return W(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Me.EMPTY_BYTE_STRING=new Me("");var gm=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Tt(n){if(Z(!!n),typeof n=="string"){let e=0,t=gm.exec(n);if(Z(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:se(n.seconds),nanos:se(n.nanos)}}function se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Lt(n){return typeof n=="string"?Me.fromBase64String(n):Me.fromUint8Array(n)}function vl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function xl(n){let e=n.mapValue.fields.__previous_value__;return vl(e)?xl(e):e}function Ln(n){let e=Tt(n.mapValue.fields.__local_write_time__.timestampValue);return new xe(e.seconds,e.nanos)}var $s=class{constructor(e,t,i,r,s,a,c,u,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=f}},ro=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Wr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function si(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?vl(n)?4:Au(n)?9007199254740991:10:L()}function ht(n,e){if(n===e)return!0;let t=si(n);if(t!==si(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ln(n).isEqual(Ln(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;let a=Tt(r.timestampValue),c=Tt(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return Lt(r.bytesValue).isEqual(Lt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return se(r.geoPointValue.latitude)===se(s.geoPointValue.latitude)&&se(r.geoPointValue.longitude)===se(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return se(r.integerValue)===se(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){let a=se(r.doubleValue),c=se(s.doubleValue);return a===c?On(a)===On(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return Vi(n.arrayValue.values||[],e.arrayValue.values||[],ht);case 10:return function(r,s){let a=r.mapValue.fields||{},c=s.mapValue.fields||{};if(eu(a)!==eu(c))return!1;for(let u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!ht(a[u],c[u])))return!1;return!0}(n,e);default:return L()}}function Bn(n,e){return(n.values||[]).find(t=>ht(t,e))!==void 0}function Ni(n,e){if(n===e)return 0;let t=si(n),i=si(e);if(t!==i)return W(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return W(n.booleanValue,e.booleanValue);case 2:return function(s,a){let c=se(s.integerValue||s.doubleValue),u=se(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(n,e);case 3:return tu(n.timestampValue,e.timestampValue);case 4:return tu(Ln(n),Ln(e));case 5:return W(n.stringValue,e.stringValue);case 6:return function(s,a){let c=Lt(s),u=Lt(a);return c.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let c=s.split("/"),u=a.split("/");for(let f=0;f<c.length&&f<u.length;f++){let p=W(c[f],u[f]);if(p!==0)return p}return W(c.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let c=W(se(s.latitude),se(a.latitude));return c!==0?c:W(se(s.longitude),se(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){let c=s.values||[],u=a.values||[];for(let f=0;f<c.length&&f<u.length;++f){let p=Ni(c[f],u[f]);if(p)return p}return W(c.length,u.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Wr.mapValue&&a===Wr.mapValue)return 0;if(s===Wr.mapValue)return 1;if(a===Wr.mapValue)return-1;let c=s.fields||{},u=Object.keys(c),f=a.fields||{},p=Object.keys(f);u.sort(),p.sort();for(let I=0;I<u.length&&I<p.length;++I){let E=W(u[I],p[I]);if(E!==0)return E;let S=Ni(c[u[I]],f[p[I]]);if(S!==0)return S}return W(u.length,p.length)}(n.mapValue,e.mapValue);default:throw L()}}function tu(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return W(n,e);let t=Tt(n),i=Tt(e),r=W(t.seconds,i.seconds);return r!==0?r:W(t.nanos,i.nanos)}function Oi(n){return Ws(n)}function Ws(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let i=Tt(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Lt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return O.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(let s of t.values||[])r?r=!1:i+=",",i+=Ws(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){let i=Object.keys(t.fields||{}).sort(),r="{",s=!0;for(let a of i)s?s=!1:r+=",",r+=`${a}:${Ws(t.fields[a])}`;return r+"}"}(n.mapValue):L()}function Ys(n){return!!n&&"integerValue"in n}function wl(n){return!!n&&"arrayValue"in n}function iu(n){return!!n&&"nullValue"in n}function nu(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Xr(n){return!!n&&"mapValue"in n}function Fn(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Wi(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Fn(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Fn(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Au(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Ze=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Xr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fn(t)}setAll(e){let t=ze.emptyPath(),i={},r=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){let u=this.getFieldsMap(t);this.applyChanges(u,i,r),i={},r=[],t=c.popLast()}a?i[c.lastSegment()]=Fn(a):r.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());Xr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ht(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Xr(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Wi(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n(Fn(this.value))}};function Ru(n){let e=[];return Wi(n.fields,(t,i)=>{let r=new ze([t]);if(Xr(i)){let s=Ru(i.mapValue).fields;if(s.length===0)e.push(r);else for(let a of s)e.push(r.child(a))}else e.push(r)}),new at(e)}var tt=class n{constructor(e,t,i,r,s,a,c){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new n(e,0,q.min(),q.min(),q.min(),Ze.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,q.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,q.min(),q.min(),Ze.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,q.min(),q.min(),Ze.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Li=class{constructor(e,t){this.position=e,this.inclusive=t}};function ru(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],a=n.position[r];if(s.field.isKeyField()?i=O.comparator(O.fromName(a.referenceValue),t.key):i=Ni(a,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function ou(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ht(n.position[t],e.position[t]))return!1;return!0}var Bi=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function _m(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var oo=class{},me=class n extends oo{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Js(e,t,i):t==="array-contains"?new ta(e,i):t==="in"?new ia(e,i):t==="not-in"?new na(e,i):t==="array-contains-any"?new ra(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Zs(e,i):new ea(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ni(t,this.value)):t!==null&&si(this.value)===si(t)&&this.matchesComparison(Ni(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ft=class n extends oo{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return ku(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function ku(n){return n.op==="and"}function Pu(n){return ym(n)&&ku(n)}function ym(n){for(let e of n.filters)if(e instanceof ft)return!1;return!0}function Xs(n){if(n instanceof me)return n.field.canonicalString()+n.op.toString()+Oi(n.value);if(Pu(n))return n.filters.map(e=>Xs(e)).join(",");{let e=n.filters.map(t=>Xs(t)).join(",");return`${n.op}(${e})`}}function Fu(n,e){return n instanceof me?function(i,r){return r instanceof me&&i.op===r.op&&i.field.isEqual(r.field)&&ht(i.value,r.value)}(n,e):n instanceof ft?function(i,r){return r instanceof ft&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,a,c)=>s&&Fu(a,r.filters[c]),!0):!1}(n,e):void L()}function Mu(n){return n instanceof me?function(t){return`${t.field.canonicalString()} ${t.op} ${Oi(t.value)}`}(n):n instanceof ft?function(t){return t.op.toString()+" {"+t.getFilters().map(Mu).join(" ,")+"}"}(n):"Filter"}var Js=class extends me{constructor(e,t,i){super(e,t,i),this.key=O.fromName(i.referenceValue)}matches(e){let t=O.comparator(e.key,this.key);return this.matchesComparison(t)}},Zs=class extends me{constructor(e,t){super(e,"in",t),this.keys=Vu("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ea=class extends me{constructor(e,t){super(e,"not-in",t),this.keys=Vu("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Vu(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>O.fromName(i.referenceValue))}var ta=class extends me{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return wl(t)&&Bn(t.arrayValue,this.value)}},ia=class extends me{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Bn(this.value.arrayValue,t)}},na=class extends me{constructor(e,t){super(e,"not-in",t)}matches(e){if(Bn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Bn(this.value.arrayValue,t)}},ra=class extends me{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!wl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Bn(this.value.arrayValue,i))}};var oa=class{constructor(e,t=null,i=[],r=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=a,this.endAt=c,this.ue=null}};function su(n,e=null,t=[],i=[],r=null,s=null,a=null){return new oa(n,e,t,i,r,s,a)}function bl(n){let e=B(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Xs(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Do(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Oi(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Oi(i)).join(",")),e.ue=t}return e.ue}function Il(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!_m(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Fu(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ou(n.startAt,e.startAt)&&ou(n.endAt,e.endAt)}function sa(n){return O.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var qi=class{constructor(e,t=null,i=[],r=[],s=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function vm(n,e,t,i,r,s,a,c){return new qi(n,e,t,i,r,s,a,c)}function Nu(n){return new qi(n)}function au(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function xm(n){return n.collectionGroup!==null}function Mn(n){let e=B(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new De(ze.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(f=>{f.isInequality()&&(c=c.add(f.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Bi(s,i))}),t.has(ze.keyField().canonicalString())||e.ce.push(new Bi(ze.keyField(),i))}return e.ce}function dt(n){let e=B(n);return e.le||(e.le=wm(e,Mn(n))),e.le}function wm(n,e){if(n.limitType==="F")return su(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new Bi(r.field,s)});let t=n.endAt?new Li(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Li(n.startAt.position,n.startAt.inclusive):null;return su(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function aa(n,e,t){return new qi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ao(n,e){return Il(dt(n),dt(e))&&n.limitType===e.limitType}function Ou(n){return`${bl(dt(n))}|lt:${n.limitType}`}function Si(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>Mu(r)).join(", ")}]`),Do(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>Oi(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>Oi(r)).join(",")),`Target(${i})`}(dt(n))}; limitType=${n.limitType})`}function Ro(n,e){return e.isFoundDocument()&&function(i,r){let s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):O.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(let s of Mn(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,r){for(let s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(a,c,u){let f=ru(a,c,u);return a.inclusive?f<=0:f<0}(i.startAt,Mn(i),r)||i.endAt&&!function(a,c,u){let f=ru(a,c,u);return a.inclusive?f>=0:f>0}(i.endAt,Mn(i),r))}(n,e)}function bm(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Lu(n){return(e,t)=>{let i=!1;for(let r of Mn(n)){let s=Im(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Im(n,e,t){let i=n.field.isKeyField()?O.comparator(e.key,t.key):function(s,a,c){let u=a.data.field(s),f=c.data.field(s);return u!==null&&f!==null?Ni(u,f):L()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return L()}}var Bt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Wi(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return Du(this.inner)}size(){return this.innerSize}};var Tm=new le(O.comparator);function Et(){return Tm}var Bu=new le(O.comparator);function Pn(...n){let e=Bu;for(let t of n)e=e.insert(t.key,t);return e}function qu(n){let e=Bu;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function ii(){return Vn()}function ju(){return Vn()}function Vn(){return new Bt(n=>n.toString(),(n,e)=>n.isEqual(e))}var Em=new le(O.comparator),Cm=new De(O.comparator);function U(...n){let e=Cm;for(let t of n)e=e.add(t);return e}var Sm=new De(W);function Dm(){return Sm}function zu(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:On(e)?"-0":e}}function Uu(n){return{integerValue:""+n}}function Am(n,e){return hm(e)?Uu(e):zu(n,e)}var ji=class{constructor(){this._=void 0}};function Rm(n,e,t){return n instanceof zi?function(r,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&vl(s)&&(s=xl(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof ai?Ku(n,e):n instanceof li?Qu(n,e):function(r,s){let a=Gu(r,s),c=lu(a)+lu(r.Pe);return Ys(a)&&Ys(r.Pe)?Uu(c):zu(r.serializer,c)}(n,e)}function km(n,e,t){return n instanceof ai?Ku(n,e):n instanceof li?Qu(n,e):t}function Gu(n,e){return n instanceof Ui?function(i){return Ys(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}var zi=class extends ji{},ai=class extends ji{constructor(e){super(),this.elements=e}};function Ku(n,e){let t=Hu(e);for(let i of n.elements)t.some(r=>ht(r,i))||t.push(i);return{arrayValue:{values:t}}}var li=class extends ji{constructor(e){super(),this.elements=e}};function Qu(n,e){let t=Hu(e);for(let i of n.elements)t=t.filter(r=>!ht(r,i));return{arrayValue:{values:t}}}var Ui=class extends ji{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function lu(n){return se(n.integerValue||n.doubleValue)}function Hu(n){return wl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Pm(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof ai&&r instanceof ai||i instanceof li&&r instanceof li?Vi(i.elements,r.elements,ht):i instanceof Ui&&r instanceof Ui?ht(i.Pe,r.Pe):i instanceof zi&&r instanceof zi}(n.transform,e.transform)}var la=class{constructor(e,t){this.version=e,this.transformResults=t}},Nt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Jr(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Gi=class{};function $u(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new qn(n.key,Nt.none()):new ci(n.key,n.data,Nt.none());{let t=n.data,i=Ze.empty(),r=new De(ze.comparator);for(let s of e.fields)if(!r.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?i.delete(s):i.set(s,a),r=r.add(s)}return new Ct(n.key,i,new at(r.toArray()),Nt.none())}}function Fm(n,e,t){n instanceof ci?function(r,s,a){let c=r.value.clone(),u=du(r.fieldTransforms,s,a.transformResults);c.setAll(u),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof Ct?function(r,s,a){if(!Jr(r.precondition,s))return void s.convertToUnknownDocument(a.version);let c=du(r.fieldTransforms,s,a.transformResults),u=s.data;u.setAll(Wu(r)),u.setAll(c),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):function(r,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Nn(n,e,t,i){return n instanceof ci?function(s,a,c,u){if(!Jr(s.precondition,a))return c;let f=s.value.clone(),p=uu(s.fieldTransforms,u,a);return f.setAll(p),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(n,e,t,i):n instanceof Ct?function(s,a,c,u){if(!Jr(s.precondition,a))return c;let f=uu(s.fieldTransforms,u,a),p=a.data;return p.setAll(Wu(s)),p.setAll(f),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(I=>I.field))}(n,e,t,i):function(s,a,c){return Jr(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(n,e,t)}function Mm(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=Gu(i.transform,r||null);s!=null&&(t===null&&(t=Ze.empty()),t.set(i.field,s))}return t||null}function cu(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Vi(i,r,(s,a)=>Pm(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var ci=class extends Gi{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},Ct=class extends Gi{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Wu(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function du(n,e,t){let i=new Map;Z(n.length===t.length);for(let r=0;r<t.length;r++){let s=n[r],a=s.transform,c=e.data.field(s.field);i.set(s.field,km(a,c,t[r]))}return i}function uu(n,e,t){let i=new Map;for(let r of n){let s=r.transform,a=t.data.field(r.field);i.set(r.field,Rm(s,a,e))}return i}var qn=class extends Gi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ca=class extends Gi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var da=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];s.key.isEqual(e.key)&&Fm(s,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=Nn(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=Nn(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=ju();return this.mutations.forEach(r=>{let s=e.get(r.key),a=s.overlayedDocument,c=this.applyToLocalView(a,s.mutatedFields);c=t.has(r.key)?null:c;let u=$u(a,c);u!==null&&i.set(r.key,u),a.isValidDocument()||a.convertToNoDocument(q.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),U())}isEqual(e){return this.batchId===e.batchId&&Vi(this.mutations,e.mutations,(t,i)=>cu(t,i))&&Vi(this.baseMutations,e.baseMutations,(t,i)=>cu(t,i))}},ua=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Z(e.mutations.length===i.length);let r=function(){return Em}(),s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,i[a].version);return new n(e,t,i,r)}};var ha=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var fa=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ue,Q;function Vm(n){switch(n){default:return L();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function Yu(n){if(n===void 0)return It("GRPC error has no .code"),C.UNKNOWN;switch(n){case ue.OK:return C.OK;case ue.CANCELLED:return C.CANCELLED;case ue.UNKNOWN:return C.UNKNOWN;case ue.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case ue.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case ue.INTERNAL:return C.INTERNAL;case ue.UNAVAILABLE:return C.UNAVAILABLE;case ue.UNAUTHENTICATED:return C.UNAUTHENTICATED;case ue.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case ue.NOT_FOUND:return C.NOT_FOUND;case ue.ALREADY_EXISTS:return C.ALREADY_EXISTS;case ue.PERMISSION_DENIED:return C.PERMISSION_DENIED;case ue.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case ue.ABORTED:return C.ABORTED;case ue.OUT_OF_RANGE:return C.OUT_OF_RANGE;case ue.UNIMPLEMENTED:return C.UNIMPLEMENTED;case ue.DATA_LOSS:return C.DATA_LOSS;default:return L()}}(Q=ue||(ue={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";var hu=null;function Nm(){return new TextEncoder}var Om=new Vt([4294967295,4294967295],0);function fu(n){let e=Nm().encode(n),t=new Ds;return t.update(e),new Uint8Array(t.digest())}function mu(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Vt([t,i],0),new Vt([r,s],0)]}var ma=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ni(`Invalid padding: ${t}`);if(i<0)throw new ni(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ni(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ni(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Vt.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply(Vt.fromNumber(i)));return r.compare(Om)===1&&(r=new Vt([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=fu(e),[i,r]=mu(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(i,r,s);if(!this.de(a))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,r,t);return i.forEach(c=>a.insert(c)),a}insert(e){if(this.Ie===0)return;let t=fu(e),[i,r]=mu(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(i,r,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},ni=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var so=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,jn.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(q.min(),r,new le(W),Et(),U())}},jn=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,U(),U(),U())}};var Pi=class{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}},ao=class{constructor(e,t){this.targetId=e,this.me=t}},lo=class{constructor(e,t,i=Me.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},co=class{constructor(){this.fe=0,this.ge=gu(),this.pe=Me.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=U(),t=U(),i=U();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:L()}}),new jn(this.pe,this.ye,e,t,i)}ve(){this.we=!1,this.ge=gu()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},pa=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Et(),this.qe=pu(),this.Qe=new le(W)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.ve(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:L()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.ze(r)&&t(r)})}He(e){let t=e.targetId,i=e.me.count,r=this.Je(t);if(r){let s=r.target;if(sa(s))if(i===0){let a=new O(s.path);this.Ue(t,a,tt.newNoDocument(a,q.min()))}else Z(i===1);else{let a=this.Ye(t);if(a!==i){let c=this.Ze(e),u=c?this.Xe(c,e,a):1;if(u!==0){this.je(t);let f=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,f)}hu?.et(function(p,I,E,S,F){var V,A,G,H,Y,re;let Ue={localCacheCount:p,existenceFilterCount:I.count,databaseId:E.database,projectId:E.projectId},ee=I.unchangedNames;return ee&&(Ue.bloomFilter={applied:F===0,hashCount:(V=ee?.hashCount)!==null&&V!==void 0?V:0,bitmapLength:(H=(G=(A=ee?.bits)===null||A===void 0?void 0:A.bitmap)===null||G===void 0?void 0:G.length)!==null&&H!==void 0?H:0,padding:(re=(Y=ee?.bits)===null||Y===void 0?void 0:Y.padding)!==null&&re!==void 0?re:0,mightContain:x=>{var m;return(m=S?.mightContain(x))!==null&&m!==void 0&&m}}),Ue}(a,e.me,this.Le.tt(),c,u))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,a,c;try{a=Lt(i).toUint8Array()}catch(u){if(u instanceof no)return Mi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new ma(a,r,s)}catch(u){return Mi(u instanceof ni?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){let i=this.Le.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let a=this.Le.tt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,s,null),r++)}),r}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let c=this.Je(a);if(c){if(s.current&&sa(c.target)){let u=new O(c.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,tt.newNoDocument(u,e))}s.be&&(t.set(a,s.Ce()),s.ve())}});let i=U();this.qe.forEach((s,a)=>{let c=!0;a.forEachWhile(u=>{let f=this.Je(u);return!f||f.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(i=i.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let r=new so(e,t,this.Qe,this.ke,i);return this.ke=Et(),this.qe=pu(),this.Qe=new le(W),r}$e(e,t){if(!this.ze(e))return;let i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;let r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new co,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new De(W),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new co),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function pu(){return new le(O.comparator)}function gu(){return new le(O.comparator)}var Lm={asc:"ASCENDING",desc:"DESCENDING"},Bm={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qm={and:"AND",or:"OR"},ga=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function _a(n,e){return n.useProto3Json||Do(e)?e:{value:e}}function uo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Xu(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function jm(n,e){return uo(n,e.toTimestamp())}function ut(n){return Z(!!n),q.fromTimestamp(function(t){let i=Tt(t);return new xe(i.seconds,i.nanos)}(n))}function Tl(n,e){return ya(n,e).canonicalString()}function ya(n,e){let t=function(r){return new ae(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Ju(n){let e=ae.fromString(n);return Z(nh(e)),e}function va(n,e){return Tl(n.databaseId,e.path)}function Vs(n,e){let t=Ju(e);if(t.get(1)!==n.databaseId.projectId)throw new N(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new N(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new O(eh(t))}function Zu(n,e){return Tl(n.databaseId,e)}function zm(n){let e=Ju(n);return e.length===4?ae.emptyPath():eh(e)}function xa(n){return new ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function eh(n){return Z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function _u(n,e,t){return{name:va(n,e),fields:t.value.mapValue.fields}}function Um(n,e){let t;if("targetChange"in e){e.targetChange;let i=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:L()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(f,p){return f.useProto3Json?(Z(p===void 0||typeof p=="string"),Me.fromBase64String(p||"")):(Z(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Me.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(f){let p=f.code===void 0?C.UNKNOWN:Yu(f.code);return new N(p,f.message||"")}(a);t=new lo(i,r,s,c||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=Vs(n,i.document.name),s=ut(i.document.updateTime),a=i.document.createTime?ut(i.document.createTime):q.min(),c=new Ze({mapValue:{fields:i.document.fields}}),u=tt.newFoundDocument(r,s,a,c),f=i.targetIds||[],p=i.removedTargetIds||[];t=new Pi(f,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=Vs(n,i.document),s=i.readTime?ut(i.readTime):q.min(),a=tt.newNoDocument(r,s),c=i.removedTargetIds||[];t=new Pi([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=Vs(n,i.document),s=i.removedTargetIds||[];t=new Pi([],s,r,null)}else{if(!("filter"in e))return L();{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,a=new fa(r,s),c=i.targetId;t=new ao(c,a)}}return t}function Gm(n,e){let t;if(e instanceof ci)t={update:_u(n,e.key,e.value)};else if(e instanceof qn)t={delete:va(n,e.key)};else if(e instanceof Ct)t={update:_u(n,e.key,e.data),updateMask:Zm(e.fieldMask)};else{if(!(e instanceof ca))return L();t={verify:va(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,a){let c=a.transform;if(c instanceof zi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof ai)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof li)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Ui)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw L()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:jm(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:L()}(n,e.precondition)),t}function Km(n,e){return n&&n.length>0?(Z(e!==void 0),n.map(t=>function(r,s){let a=r.updateTime?ut(r.updateTime):ut(s);return a.isEqual(q.min())&&(a=ut(s)),new la(a,r.transformResults||[])}(t,e))):[]}function Qm(n,e){return{documents:[Zu(n,e.path)]}}function Hm(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Zu(n,r);let s=function(f){if(f.length!==0)return ih(ft.create(f,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(f){if(f.length!==0)return f.map(p=>function(E){return{field:Di(E.field),direction:Ym(E.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let c=_a(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{_t:t,parent:r}}function $m(n){let e=zm(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){Z(i===1);let p=t.from[0];p.allDescendants?r=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(I){let E=th(I);return E instanceof ft&&Pu(E)?E.getFilters():[E]}(t.where));let a=[];t.orderBy&&(a=function(I){return I.map(E=>function(F){return new Bi(Ai(F.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(F.direction))}(E))}(t.orderBy));let c=null;t.limit&&(c=function(I){let E;return E=typeof I=="object"?I.value:I,Do(E)?null:E}(t.limit));let u=null;t.startAt&&(u=function(I){let E=!!I.before,S=I.values||[];return new Li(S,E)}(t.startAt));let f=null;return t.endAt&&(f=function(I){let E=!I.before,S=I.values||[];return new Li(S,E)}(t.endAt)),vm(e,r,a,s,c,"F",u,f)}function Wm(n,e){let t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return L()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function th(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=Ai(t.unaryFilter.field);return me.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=Ai(t.unaryFilter.field);return me.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ai(t.unaryFilter.field);return me.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Ai(t.unaryFilter.field);return me.create(a,"!=",{nullValue:"NULL_VALUE"});default:return L()}}(n):n.fieldFilter!==void 0?function(t){return me.create(Ai(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return L()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ft.create(t.compositeFilter.filters.map(i=>th(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return L()}}(t.compositeFilter.op))}(n):L()}function Ym(n){return Lm[n]}function Xm(n){return Bm[n]}function Jm(n){return qm[n]}function Di(n){return{fieldPath:n.canonicalString()}}function Ai(n){return ze.fromServerFormat(n.fieldPath)}function ih(n){return n instanceof me?function(t){if(t.op==="=="){if(nu(t.value))return{unaryFilter:{field:Di(t.field),op:"IS_NAN"}};if(iu(t.value))return{unaryFilter:{field:Di(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(nu(t.value))return{unaryFilter:{field:Di(t.field),op:"IS_NOT_NAN"}};if(iu(t.value))return{unaryFilter:{field:Di(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Di(t.field),op:Xm(t.op),value:t.value}}}(n):n instanceof ft?function(t){let i=t.getFilters().map(r=>ih(r));return i.length===1?i[0]:{compositeFilter:{op:Jm(t.op),filters:i}}}(n):L()}function Zm(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function nh(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var zn=class n{constructor(e,t,i,r,s=q.min(),a=q.min(),c=Me.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var wa=class{constructor(e){this.ct=e}};function ep(n){let e=$m({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?aa(e,e.limit,"L"):e}var ho=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(se(e.integerValue));else if("doubleValue"in e){let i=se(e.doubleValue);isNaN(i)?this.Et(t,13):(this.Et(t,15),On(i)?t.dt(0):t.dt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Et(t,20),typeof i=="string"&&(i=Tt(i)),t.At(`${i.seconds||""}`),t.dt(i.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Lt(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Et(t,45),t.dt(i.latitude||0),t.dt(i.longitude||0)}else"mapValue"in e?Au(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):L()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let i=e.fields||{};this.Et(t,55);for(let r of Object.keys(i))this.Rt(r,t),this.It(i[r],t)}wt(e,t){let i=e.values||[];this.Et(t,50);for(let r of i)this.It(r,t)}gt(e,t){this.Et(t,37),O.fromName(e).path.forEach(i=>{this.Et(t,60),this.St(i,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};ho.bt=new ho;var ba=class{constructor(){this._n=new Ia}addToCollectionParentIndex(e,t){return this._n.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(oi.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(oi.min())}updateCollectionGroup(e,t,i){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}},Ia=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new De(ae.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new De(ae.comparator)).toArray()}};var Hy=new Uint8Array(0);var st=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};st.DEFAULT_COLLECTION_PERCENTILE=10,st.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,st.DEFAULT=new st(41943040,st.DEFAULT_COLLECTION_PERCENTILE,st.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),st.DISABLED=new st(-1,0,0);var Un=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var Ta=class{constructor(){this.changes=new Bt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,tt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?D.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ea=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ca=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Nn(i.mutation,r,at.empty(),xe.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,U()).next(()=>i))}getLocalViewOfDocuments(e,t,i=U()){let r=ii();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let a=Pn();return s.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let i=ii();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,U()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,i,r){let s=Et(),a=Vn(),c=function(){return Vn()}();return t.forEach((u,f)=>{let p=i.get(f.key);r.has(f.key)&&(p===void 0||p.mutation instanceof Ct)?s=s.insert(f.key,f):p!==void 0?(a.set(f.key,p.mutation.getFieldMask()),Nn(p.mutation,f,p.mutation.getFieldMask(),xe.now())):a.set(f.key,at.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((f,p)=>a.set(f,p)),t.forEach((f,p)=>{var I;return c.set(f,new Ea(p,(I=a.get(f))!==null&&I!==void 0?I:null))}),c))}recalculateAndSaveOverlays(e,t){let i=Vn(),r=new le((a,c)=>a-c),s=U();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let c of a)c.keys().forEach(u=>{let f=t.get(u);if(f===null)return;let p=i.get(u)||at.empty();p=c.applyToLocalView(f,p),i.set(u,p);let I=(r.get(c.batchId)||U()).add(u);r=r.insert(c.batchId,I)})}).next(()=>{let a=[],c=r.getReverseIterator();for(;c.hasNext();){let u=c.getNext(),f=u.key,p=u.value,I=ju();p.forEach(E=>{if(!s.has(E)){let S=$u(t.get(E),i.get(E));S!==null&&I.set(E,S),s=s.add(E)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,I))}return D.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(a){return O.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):xm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):D.resolve(ii()),c=-1,u=s;return a.next(f=>D.forEach(f,(p,I)=>(c<I.largestBatchId&&(c=I.largestBatchId),s.get(p)?D.resolve():this.remoteDocumentCache.getEntry(e,p).next(E=>{u=u.insert(p,E)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,u,f,U())).next(p=>({batchId:c,changes:qu(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new O(t)).next(i=>{let r=Pn();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,a=Pn();return this.indexManager.getCollectionParents(e,s).next(c=>D.forEach(c,u=>{let f=function(I,E){return new qi(E,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,i,r).next(p=>{p.forEach((I,E)=>{a=a.insert(I,E)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(a=>{s.forEach((u,f)=>{let p=f.getKey();a.get(p)===null&&(a=a.insert(p,tt.newInvalidDocument(p)))});let c=Pn();return a.forEach((u,f)=>{let p=s.get(u);p!==void 0&&Nn(p.mutation,f,at.empty(),xe.now()),Ro(t,f)&&(c=c.insert(u,f))}),c})}};var Sa=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return D.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:ut(r.createTime)}}(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(r){return{name:r.name,query:ep(r.bundledQuery),readTime:ut(r.readTime)}}(t)),D.resolve()}};var Da=class{constructor(){this.overlays=new le(O.comparator),this.hr=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){let i=ii();return D.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.ht(e,t,s)}),D.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.hr.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(i)),D.resolve()}getOverlaysForCollection(e,t,i){let r=ii(),s=t.length+1,a=new O(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){let u=c.getNext().value,f=u.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&u.largestBatchId>i&&r.set(u.getKey(),u)}return D.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new le((f,p)=>f-p),a=this.overlays.getIterator();for(;a.hasNext();){let f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>i){let p=s.get(f.largestBatchId);p===null&&(p=ii(),s=s.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}let c=ii(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((f,p)=>c.set(f,p)),!(c.size()>=r)););return D.resolve(c)}ht(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let a=this.hr.get(r.largestBatchId).delete(i.key);this.hr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new ha(t,i));let s=this.hr.get(t);s===void 0&&(s=U(),this.hr.set(t,s)),this.hr.set(t,s.add(i.key))}};var Gn=class{constructor(){this.Pr=new De(he.Ir),this.Tr=new De(he.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let i=new he(e,t);this.Pr=this.Pr.add(i),this.Tr=this.Tr.add(i)}dr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Ar(new he(e,t))}Rr(e,t){e.forEach(i=>this.removeReference(i,t))}Vr(e){let t=new O(new ae([])),i=new he(t,e),r=new he(t,e+1),s=[];return this.Tr.forEachInRange([i,r],a=>{this.Ar(a),s.push(a.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new O(new ae([])),i=new he(t,e),r=new he(t,e+1),s=U();return this.Tr.forEachInRange([i,r],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new he(e,0),i=this.Pr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},he=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return O.comparator(e.key,t.key)||W(e.pr,t.pr)}static Er(e,t){return W(e.pr,t.pr)||O.comparator(e.key,t.key)}};var Aa=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new De(he.Ir)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new da(s,t,i,r);this.mutationQueue.push(a);for(let c of r)this.wr=this.wr.add(new he(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return D.resolve(a)}lookupMutationBatch(e,t){return D.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.br(i),s=r<0?0:r;return D.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new he(t,0),r=new he(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([i,r],a=>{let c=this.Sr(a.pr);s.push(c)}),D.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new De(W);return t.forEach(r=>{let s=new he(r,0),a=new he(r,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,a],c=>{i=i.add(c.pr)})}),D.resolve(this.Dr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;O.isDocumentKey(s)||(s=s.child(""));let a=new he(new O(s),0),c=new De(W);return this.wr.forEachWhile(u=>{let f=u.key.path;return!!i.isPrefixOf(f)&&(f.length===r&&(c=c.add(u.pr)),!0)},a),D.resolve(this.Dr(c))}Dr(e){let t=[];return e.forEach(i=>{let r=this.Sr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){Z(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.wr;return D.forEach(t.mutations,r=>{let s=new he(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.wr=i})}Mn(e){}containsKey(e,t){let i=new he(t,0),r=this.wr.firstAfterOrEqual(i);return D.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Ra=class{constructor(e){this.vr=e,this.docs=function(){return new le(O.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,a=this.vr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return D.resolve(i?i.document.mutableCopy():tt.newInvalidDocument(t))}getEntries(e,t){let i=Et();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():tt.newInvalidDocument(r))}),D.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Et(),a=t.path,c=new O(a.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){let{key:f,value:{document:p}}=u.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||cm(lm(p),i)<=0||(r.has(p.key)||Ro(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return D.resolve(s)}getAllFromCollectionGroup(e,t,i,r){L()}Fr(e,t){return D.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new ka(this)}getSize(e){return D.resolve(this.size)}},ka=class extends Ta{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(i)}),D.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var Pa=class{constructor(e){this.persistence=e,this.Mr=new Bt(t=>bl(t),Il),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Gn,this.targetCount=0,this.Lr=Un.Nn()}forEachTarget(e,t){return this.Mr.forEach((i,r)=>t(r)),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Or&&(this.Or=t),D.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new Un(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.qn(t),D.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.Mr.forEach((a,c)=>{c.sequenceNumber<=t&&i.get(c.targetId)===null&&(this.Mr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),D.waitFor(s).next(()=>r)}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){let i=this.Mr.get(t)||null;return D.resolve(i)}addMatchingKeys(e,t,i){return this.Nr.dr(t,i),D.resolve()}removeMatchingKeys(e,t,i){this.Nr.Rr(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(a=>{s.push(r.markPotentiallyOrphaned(e,a))}),D.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),D.resolve()}getMatchingKeysForTargetId(e,t){let i=this.Nr.gr(t);return D.resolve(i)}containsKey(e,t){return D.resolve(this.Nr.containsKey(t))}};var Fa=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new Su(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Pa(this),this.indexManager=new ba,this.remoteDocumentCache=function(r){return new Ra(r)}(i=>this.referenceDelegate.Kr(i)),this.serializer=new wa(t),this.$r=new Sa(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Da,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Br[e.toKey()];return i||(i=new Aa(t,this.referenceDelegate),this.Br[e.toKey()]=i),i}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,i){M("MemoryPersistence","Starting transaction:",e);let r=new Ma(this.kr.next());return this.referenceDelegate.Ur(),i(r).next(s=>this.referenceDelegate.Wr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Gr(e,t){return D.or(Object.values(this.Br).map(i=>()=>i.containsKey(e,t)))}},Ma=class extends Hs{constructor(e){super(),this.currentSequenceNumber=e}},Va=class n{constructor(e){this.persistence=e,this.zr=new Gn,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw L()}addReference(e,t,i){return this.zr.addReference(i,t),this.Jr.delete(i.toString()),D.resolve()}removeReference(e,t,i){return this.zr.removeReference(i,t),this.Jr.add(i.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),D.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(r=>this.Jr.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Jr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.Jr,i=>{let r=O.fromPath(i);return this.Yr(e,r).next(s=>{s||t.removeEntry(r,q.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(i=>{i?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return D.or([()=>D.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var Na=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.qi=i,this.Qi=r}static Ki(e,t){let i=U(),r=U();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new n(e,t.fromCache,i,r)}};var Oa=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var La=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return ud()?8:um(dd())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.ji(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Hi(e,t,r,i).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new Oa;return this.Ji(e,t,a).next(c=>{if(s.result=c,this.Ui)return this.Yi(e,t,a,c.size)})}).next(()=>s.result)}Yi(e,t,i,r){return i.documentReadCount<this.Wi?(kn()<=xt.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",Si(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),D.resolve()):(kn()<=xt.DEBUG&&M("QueryEngine","Query:",Si(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Gi*r?(kn()<=xt.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",Si(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dt(t))):D.resolve())}ji(e,t){if(au(t))return D.resolve(null);let i=dt(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=aa(t,null,"F"),i=dt(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let a=U(...s);return this.zi.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,i).next(u=>{let f=this.Zi(t,c);return this.Xi(t,f,a,u.readTime)?this.ji(e,aa(t,null,"F")):this.es(e,f,t,u)}))})))}Hi(e,t,i,r){return au(t)||r.isEqual(q.min())?D.resolve(null):this.zi.getDocuments(e,i).next(s=>{let a=this.Zi(t,s);return this.Xi(t,a,i,r)?D.resolve(null):(kn()<=xt.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Si(t)),this.es(e,a,t,am(r,-1)).next(c=>c))})}Zi(e,t){let i=new De(Lu(e));return t.forEach((r,s)=>{Ro(e,s)&&(i=i.add(s))}),i}Xi(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ji(e,t,i){return kn()<=xt.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",Si(t)),this.zi.getDocumentsMatchingQuery(e,t,oi.min(),i)}es(e,t,i,r){return this.zi.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Ba=class{constructor(e,t,i,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new le(W),this.rs=new Bt(s=>bl(s),Il),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(i)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ca(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function tp(n,e,t,i){return new Ba(n,e,t,i)}function rh(n,e){return P(this,null,function*(){let t=B(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t._s(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{let a=[],c=[],u=U();for(let f of r){a.push(f.batchId);for(let p of f.mutations)u=u.add(p.key)}for(let f of s){c.push(f.batchId);for(let p of f.mutations)u=u.add(p.key)}return t.localDocuments.getDocuments(i,u).next(f=>({us:f,removedBatchIds:a,addedBatchIds:c}))})})})}function ip(n,e){let t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(c,u,f,p){let I=f.batch,E=I.keys(),S=D.resolve();return E.forEach(F=>{S=S.next(()=>p.getEntry(u,F)).next(V=>{let A=f.docVersions.get(F);Z(A!==null),V.version.compareTo(A)<0&&(I.applyToRemoteDocument(V,f),V.isValidDocument()&&(V.setReadTime(f.commitVersion),p.addEntry(V)))})}),S.next(()=>c.mutationQueue.removeMutationBatch(u,I))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(c){let u=U();for(let f=0;f<c.mutationResults.length;++f)c.mutationResults[f].transformResults.length>0&&(u=u.add(c.batch.mutations[f].key));return u}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function oh(n){let e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function np(n,e){let t=B(n),i=e.snapshotVersion,r=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.os.newChangeBuffer({trackRemovals:!0});r=t.ns;let c=[];e.targetChanges.forEach((p,I)=>{let E=r.get(I);if(!E)return;c.push(t.Qr.removeMatchingKeys(s,p.removedDocuments,I).next(()=>t.Qr.addMatchingKeys(s,p.addedDocuments,I)));let S=E.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(I)!==null?S=S.withResumeToken(Me.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,i)),r=r.insert(I,S),function(V,A,G){return V.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=3e8?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0}(E,S,p)&&c.push(t.Qr.updateTargetData(s,S))});let u=Et(),f=U();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),c.push(rp(s,a,e.documentUpdates).next(p=>{u=p.cs,f=p.ls})),!i.isEqual(q.min())){let p=t.Qr.getLastRemoteSnapshotVersion(s).next(I=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,i));c.push(p)}return D.waitFor(c).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,f)).next(()=>u)}).then(s=>(t.ns=r,s))}function rp(n,e,t){let i=U(),r=U();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let a=Et();return t.forEach((c,u)=>{let f=s.get(c);u.isFoundDocument()!==f.isFoundDocument()&&(r=r.add(c)),u.isNoDocument()&&u.version.isEqual(q.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!f.isValidDocument()||u.version.compareTo(f.version)>0||u.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):M("LocalStore","Ignoring outdated watch update for ",c,". Current version:",f.version," Watch version:",u.version)}),{cs:a,ls:r}})}function op(n,e){let t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function sp(n,e){let t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Qr.getTargetData(i,e).next(s=>s?(r=s,D.resolve(r)):t.Qr.allocateTargetId(i).next(a=>(r=new zn(e,a,"TargetPurposeListen",i.currentSequenceNumber),t.Qr.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.ns.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.ns=t.ns.insert(i.targetId,i),t.rs.set(e,i.targetId)),i})}function qa(n,e,t){return P(this,null,function*(){let i=B(n),r=i.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,a=>i.persistence.referenceDelegate.removeTarget(a,r)))}catch(a){if(!Yn(a))throw a;M("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}i.ns=i.ns.remove(e),i.rs.delete(r.target)})}function yu(n,e,t){let i=B(n),r=q.min(),s=U();return i.persistence.runTransaction("Execute query","readwrite",a=>function(u,f,p){let I=B(u),E=I.rs.get(p);return E!==void 0?D.resolve(I.ns.get(E)):I.Qr.getTargetData(f,p)}(i,a,dt(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,i.Qr.getMatchingKeysForTargetId(a,c.targetId).next(u=>{s=u})}).next(()=>i.ts.getDocumentsMatchingQuery(a,e,t?r:q.min(),t?s:U())).next(c=>(ap(i,bm(e),c),{documents:c,hs:s})))}function ap(n,e,t){let i=n.ss.get(e)||q.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.ss.set(e,i)}var fo=class{constructor(){this.activeTargetIds=Dm()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ja=class{constructor(){this.no=new fo,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,i){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new fo,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var za=class{io(e){}shutdown(){}};var mo=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Yr=null;function Ns(){return Yr===null?Yr=function(){return 268435456+Math.round(2147483648*Math.random())}():Yr++,"0x"+Yr.toString(16)}var lp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Ua=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var Se="WebChannelConnection",Ga=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=i+"://"+t.host,this.So=`projects/${r}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Do(){return!1}Co(t,i,r,s,a){let c=Ns(),u=this.vo(t,i.toUriEncodedString());M("RestConnection",`Sending RPC '${t}' ${c}:`,u,r);let f={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(f,s,a),this.Mo(t,u,f,r).then(p=>(M("RestConnection",`Received RPC '${t}' ${c}: `,p),p),p=>{throw Mi("RestConnection",`RPC '${t}' ${c} failed with error: `,p,"url: ",u,"request:",r),p})}xo(t,i,r,s,a,c){return this.Co(t,i,r,s,a)}Fo(t,i,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$i}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,a)=>t[a]=s),r&&r.headers.forEach((s,a)=>t[a]=s)}vo(t,i){let r=lp[t];return`${this.wo}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,i,r){let s=Ns();return new Promise((a,c)=>{let u=new As;u.setWithCredentials(!0),u.listenOnce(ks.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Rn.NO_ERROR:let p=u.getResponseJson();M(Se,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case Rn.TIMEOUT:M(Se,`RPC '${e}' ${s} timed out`),c(new N(C.DEADLINE_EXCEEDED,"Request time out"));break;case Rn.HTTP_ERROR:let I=u.getStatus();if(M(Se,`RPC '${e}' ${s} failed with status:`,I,"response text:",u.getResponseText()),I>0){let E=u.getResponseJson();Array.isArray(E)&&(E=E[0]);let S=E?.error;if(S&&S.status&&S.message){let F=function(A){let G=A.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(G)>=0?G:C.UNKNOWN}(S.status);c(new N(F,S.message))}else c(new N(C.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new N(C.UNAVAILABLE,"Connection failed."));break;default:L()}}finally{M(Se,`RPC '${e}' ${s} completed.`)}});let f=JSON.stringify(r);M(Se,`RPC '${e}' ${s} sending request:`,r),u.send(t,"POST",f,i,15)})}Oo(e,t,i){let r=Ns(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Ms(),c=Fs(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(u.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(u.xmlHttpFactory=new Rs({})),this.Fo(u.initMessageHeaders,t,i),u.encodeInitMessageHeaders=!0;let p=s.join("");M(Se,`Creating RPC '${e}' stream ${r}: ${p}`,u);let I=a.createWebChannel(p,u),E=!1,S=!1,F=new Ua({lo:A=>{S?M(Se,`Not sending because RPC '${e}' stream ${r} is closed:`,A):(E||(M(Se,`Opening RPC '${e}' stream ${r} transport.`),I.open(),E=!0),M(Se,`RPC '${e}' stream ${r} sending:`,A),I.send(A))},ho:()=>I.close()}),V=(A,G,H)=>{A.listen(G,Y=>{try{H(Y)}catch(re){setTimeout(()=>{throw re},0)}})};return V(I,Ci.EventType.OPEN,()=>{S||(M(Se,`RPC '${e}' stream ${r} transport opened.`),F.mo())}),V(I,Ci.EventType.CLOSE,()=>{S||(S=!0,M(Se,`RPC '${e}' stream ${r} transport closed`),F.po())}),V(I,Ci.EventType.ERROR,A=>{S||(S=!0,Mi(Se,`RPC '${e}' stream ${r} transport errored:`,A),F.po(new N(C.UNAVAILABLE,"The operation could not be completed")))}),V(I,Ci.EventType.MESSAGE,A=>{var G;if(!S){let H=A.data[0];Z(!!H);let Y=H,re=Y.error||((G=Y[0])===null||G===void 0?void 0:G.error);if(re){M(Se,`RPC '${e}' stream ${r} received error:`,re);let Ue=re.status,ee=function(_){let y=ue[_];if(y!==void 0)return Yu(y)}(Ue),x=re.message;ee===void 0&&(ee=C.INTERNAL,x="Unknown error status: "+Ue+" with message "+re.message),S=!0,F.po(new N(ee,x)),I.close()}else M(Se,`RPC '${e}' stream ${r} received:`,H),F.yo(H)}}),V(c,Ps.STAT_EVENT,A=>{A.stat===$r.PROXY?M(Se,`RPC '${e}' stream ${r} detected buffering proxy`):A.stat===$r.NOPROXY&&M(Se,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{F.fo()},0),F}};function Os(){return typeof document<"u"?document:null}function ko(n){return new ga(n,!0)}var po=class{constructor(e,t,i=1e3,r=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=i,this.Lo=r,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),i=Math.max(0,Date.now()-this.Qo),r=Math.max(0,t-i);r>0&&M("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,r,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var go=class{constructor(e,t,i,r,s,a,c,u){this.oi=e,this.Go=i,this.zo=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new po(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return P(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return P(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return P(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(It(t.toString()),It("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.jo===t&&this.u_(i,r)},i=>{e(()=>{let r=new N(C.UNKNOWN,"Fetching auth token failed: "+i.message);return this.c_(r)})})}u_(e,t){let i=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{i(()=>this.listener.Po())}),this.stream.To(()=>{i(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(r=>{i(()=>this.c_(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}e_(){this.state=5,this.Yo.$o(()=>P(this,null,function*(){this.state=0,this.start()}))}c_(e){return M("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Ka=class extends go{constructor(e,t,i,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,a),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=Um(this.serializer,e),i=function(s){if(!("targetChange"in s))return q.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?q.min():a.readTime?ut(a.readTime):q.min()}(e);return this.listener.h_(t,i)}P_(e){let t={};t.database=xa(this.serializer),t.addTarget=function(s,a){let c,u=a.target;if(c=sa(u)?{documents:Qm(s,u)}:{query:Hm(s,u)._t},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Xu(s,a.resumeToken);let f=_a(s,a.expectedCount);f!==null&&(c.expectedCount=f)}else if(a.snapshotVersion.compareTo(q.min())>0){c.readTime=uo(s,a.snapshotVersion.toTimestamp());let f=_a(s,a.expectedCount);f!==null&&(c.expectedCount=f)}return c}(this.serializer,e);let i=Wm(this.serializer,e);i&&(t.labels=i),this.i_(t)}I_(e){let t={};t.database=xa(this.serializer),t.removeTarget=e,this.i_(t)}},Qa=class extends go{constructor(e,t,i,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,a),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(Z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=Km(e.writeResults,e.commitTime),i=ut(e.commitTime);return this.listener.A_(i,t)}return Z(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=xa(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>Gm(this.serializer,i))};this.i_(t)}};var Ha=class extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.m_=!1}f_(){if(this.m_)throw new N(C.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,i,r){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,ya(t,i),r,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new N(C.UNKNOWN,s.toString())})}xo(e,t,i,r,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.xo(e,ya(t,i),r,a,c,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new N(C.UNKNOWN,a.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},$a=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(It(t),this.y_=!1):M("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var Wa=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(a=>{i.enqueueAndForget(()=>P(this,null,function*(){di(this)&&(M("RemoteStore","Restarting streams for network reachability change."),yield function(u){return P(this,null,function*(){let f=B(u);f.M_.add(4),yield Xn(f),f.N_.set("Unknown"),f.M_.delete(4),yield Po(f)})}(this))}))}),this.N_=new $a(i,r)}};function Po(n){return P(this,null,function*(){if(di(n))for(let e of n.x_)yield e(!0)})}function Xn(n){return P(this,null,function*(){for(let e of n.x_)yield e(!1)})}function sh(n,e){let t=B(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),Dl(t)?Sl(t):Yi(t).Xo()&&Cl(t,e))}function El(n,e){let t=B(n),i=Yi(t);t.F_.delete(e),i.Xo()&&ah(t,e),t.F_.size===0&&(i.Xo()?i.n_():di(t)&&t.N_.set("Unknown"))}function Cl(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Yi(n).P_(e)}function ah(n,e){n.L_.xe(e),Yi(n).I_(e)}function Sl(n){n.L_=new pa({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Yi(n).start(),n.N_.w_()}function Dl(n){return di(n)&&!Yi(n).Zo()&&n.F_.size>0}function di(n){return B(n).M_.size===0}function lh(n){n.L_=void 0}function cp(n){return P(this,null,function*(){n.N_.set("Online")})}function dp(n){return P(this,null,function*(){n.F_.forEach((e,t)=>{Cl(n,e)})})}function up(n,e){return P(this,null,function*(){lh(n),Dl(n)?(n.N_.D_(e),Sl(n)):n.N_.set("Unknown")})}function hp(n,e,t){return P(this,null,function*(){if(n.N_.set("Online"),e instanceof lo&&e.state===2&&e.cause)try{yield function(r,s){return P(this,null,function*(){let a=s.cause;for(let c of s.targetIds)r.F_.has(c)&&(yield r.remoteSyncer.rejectListen(c,a),r.F_.delete(c),r.L_.removeTarget(c))})}(n,e)}catch(i){M("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield _o(n,i)}else if(e instanceof Pi?n.L_.Ke(e):e instanceof ao?n.L_.He(e):n.L_.We(e),!t.isEqual(q.min()))try{let i=yield oh(n.localStore);t.compareTo(i)>=0&&(yield function(s,a){let c=s.L_.rt(a);return c.targetChanges.forEach((u,f)=>{if(u.resumeToken.approximateByteSize()>0){let p=s.F_.get(f);p&&s.F_.set(f,p.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,f)=>{let p=s.F_.get(u);if(!p)return;s.F_.set(u,p.withResumeToken(Me.EMPTY_BYTE_STRING,p.snapshotVersion)),ah(s,u);let I=new zn(p.target,u,f,p.sequenceNumber);Cl(s,I)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(i){M("RemoteStore","Failed to raise snapshot:",i),yield _o(n,i)}})}function _o(n,e,t){return P(this,null,function*(){if(!Yn(e))throw e;n.M_.add(1),yield Xn(n),n.N_.set("Offline"),t||(t=()=>oh(n.localStore)),n.asyncQueue.enqueueRetryable(()=>P(this,null,function*(){M("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield Po(n)}))})}function ch(n,e){return e().catch(t=>_o(n,t,e))}function Fo(n){return P(this,null,function*(){let e=B(n),t=qt(e),i=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;fp(e);)try{let r=yield op(e.localStore,i);if(r===null){e.v_.length===0&&t.n_();break}i=r.batchId,mp(e,r)}catch(r){yield _o(e,r)}dh(e)&&uh(e)})}function fp(n){return di(n)&&n.v_.length<10}function mp(n,e){n.v_.push(e);let t=qt(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function dh(n){return di(n)&&!qt(n).Zo()&&n.v_.length>0}function uh(n){qt(n).start()}function pp(n){return P(this,null,function*(){qt(n).V_()})}function gp(n){return P(this,null,function*(){let e=qt(n);for(let t of n.v_)e.d_(t.mutations)})}function _p(n,e,t){return P(this,null,function*(){let i=n.v_.shift(),r=ua.from(i,e,t);yield ch(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield Fo(n)})}function yp(n,e){return P(this,null,function*(){e&&qt(n).E_&&(yield function(i,r){return P(this,null,function*(){if(function(a){return Vm(a)&&a!==C.ABORTED}(r.code)){let s=i.v_.shift();qt(i).t_(),yield ch(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),yield Fo(i)}})}(n,e)),dh(n)&&uh(n)})}function vu(n,e){return P(this,null,function*(){let t=B(n);t.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");let i=di(t);t.M_.add(3),yield Xn(t),i&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield Po(t)})}function vp(n,e){return P(this,null,function*(){let t=B(n);e?(t.M_.delete(2),yield Po(t)):e||(t.M_.add(2),yield Xn(t),t.N_.set("Unknown"))})}function Yi(n){return n.B_||(n.B_=function(t,i,r){let s=B(t);return s.f_(),new Ka(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Po:cp.bind(null,n),To:dp.bind(null,n),Ao:up.bind(null,n),h_:hp.bind(null,n)}),n.x_.push(e=>P(this,null,function*(){e?(n.B_.t_(),Dl(n)?Sl(n):n.N_.set("Unknown")):(yield n.B_.stop(),lh(n))}))),n.B_}function qt(n){return n.k_||(n.k_=function(t,i,r){let s=B(t);return s.f_(),new Qa(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:pp.bind(null,n),Ao:yp.bind(null,n),R_:gp.bind(null,n),A_:_p.bind(null,n)}),n.x_.push(e=>P(this,null,function*(){e?(n.k_.t_(),yield Fo(n)):(yield n.k_.stop(),n.v_.length>0&&(M("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var Ya=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new lt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let a=Date.now()+i,c=new n(e,t,a,r,s);return c.start(i),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new N(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Al(n,e){if(It("AsyncQueue",`${e}: ${n}`),Yn(n))return new N(C.UNAVAILABLE,`${e}: ${n}`);throw n}var yo=class n{constructor(e){this.comparator=e?(t,i)=>e(t,i)||O.comparator(t.key,i.key):(t,i)=>O.comparator(t.key,i.key),this.keyedMap=Pn(),this.sortedSet=new le(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var vo=class{constructor(){this.q_=new le(O.comparator)}track(e){let t=e.doc.key,i=this.q_.get(t);i?e.type!==0&&i.type===3?this.q_=this.q_.insert(t,e):e.type===3&&i.type!==1?this.q_=this.q_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.q_=this.q_.remove(t):e.type===1&&i.type===2?this.q_=this.q_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):L():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,i)=>{e.push(i)}),e}},Ki=class n{constructor(e,t,i,r,s,a,c,u,f){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=f}static fromInitialDocuments(e,t,i,r,s){let a=[];return t.forEach(c=>{a.push({type:0,doc:c})}),new n(e,t,yo.emptySet(t),a,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ao(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var Xa=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},Ja=class{constructor(){this.queries=new Bt(e=>Ou(e),Ao),this.onlineState="Unknown",this.z_=new Set}};function xp(n,e){return P(this,null,function*(){let t=B(n),i=3,r=e.query,s=t.queries.get(r);s?!s.W_()&&e.G_()&&(i=2):(s=new Xa,i=e.G_()?0:1);try{switch(i){case 0:s.K_=yield t.onListen(r,!0);break;case 1:s.K_=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(a){let c=Al(a,`Initialization of query '${Si(e.query)}' failed`);return void e.onError(c)}t.queries.set(r,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&Rl(t)})}function wp(n,e){return P(this,null,function*(){let t=B(n),i=e.query,r=3,s=t.queries.get(i);if(s){let a=s.U_.indexOf(e);a>=0&&(s.U_.splice(a,1),s.U_.length===0?r=e.G_()?0:1:!s.W_()&&e.G_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function bp(n,e){let t=B(n),i=!1;for(let r of e){let s=r.query,a=t.queries.get(s);if(a){for(let c of a.U_)c.H_(r)&&(i=!0);a.K_=r}}i&&Rl(t)}function Ip(n,e,t){let i=B(n),r=i.queries.get(e);if(r)for(let s of r.U_)s.onError(t);i.queries.delete(e)}function Rl(n){n.z_.forEach(e=>{e.next()})}var Za,xu;(xu=Za||(Za={})).J_="default",xu.Cache="cache";var el=class{constructor(e,t,i){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=i||{}}H_(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Ki(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let i=t!=="Offline";return(!this.options.ra||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Ki.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Za.Cache}};var xo=class{constructor(e){this.key=e}},wo=class{constructor(e){this.key=e}},tl=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=U(),this.mutatedKeys=U(),this.Ia=Lu(e),this.Ta=new yo(this.Ia)}get Ea(){return this.la}da(e,t){let i=t?t.Aa:new vo,r=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,a=r,c=!1,u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,f=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((p,I)=>{let E=r.get(p),S=Ro(this.query,I)?I:null,F=!!E&&this.mutatedKeys.has(E.key),V=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),A=!1;E&&S?E.data.isEqual(S.data)?F!==V&&(i.track({type:3,doc:S}),A=!0):this.Ra(E,S)||(i.track({type:2,doc:S}),A=!0,(u&&this.Ia(S,u)>0||f&&this.Ia(S,f)<0)&&(c=!0)):!E&&S?(i.track({type:0,doc:S}),A=!0):E&&!S&&(i.track({type:1,doc:E}),A=!0,(u||f)&&(c=!0)),A&&(S?(a=a.add(S),s=V?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),i.track({type:1,doc:p})}return{Ta:a,Aa:i,Xi:c,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let a=e.Aa.Q_();a.sort((p,I)=>function(S,F){let V=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L()}};return V(S)-V(F)}(p.type,I.type)||this.Ia(p.doc,I.doc)),this.Va(i),r=r!=null&&r;let c=t&&!r?this.ma():[],u=this.Pa.size===0&&this.current&&!r?1:0,f=u!==this.ha;return this.ha=u,a.length!==0||f?{snapshot:new Ki(this.query,e.Ta,s,a,e.mutatedKeys,u===0,f,!1,!!i&&i.resumeToken.approximateByteSize()>0),fa:c}:{fa:c}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new vo,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=U(),this.Ta.forEach(i=>{this.ga(i.key)&&(this.Pa=this.Pa.add(i.key))});let t=[];return e.forEach(i=>{this.Pa.has(i)||t.push(new wo(i))}),this.Pa.forEach(i=>{e.has(i)||t.push(new xo(i))}),t}pa(e){this.la=e.hs,this.Pa=U();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Ki.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},il=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},nl=class{constructor(e){this.key=e,this.wa=!1}},rl=class{constructor(e,t,i,r,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Sa={},this.ba=new Bt(c=>Ou(c),Ao),this.Da=new Map,this.Ca=new Set,this.va=new le(O.comparator),this.Fa=new Map,this.Ma=new Gn,this.xa={},this.Oa=new Map,this.Na=Un.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function Tp(n,e,t=!0){return P(this,null,function*(){let i=_h(n),r,s=i.ba.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.ya()):r=yield hh(i,e,t,!0),r})}function Ep(n,e){return P(this,null,function*(){let t=_h(n);yield hh(t,e,!0,!1)})}function hh(n,e,t,i){return P(this,null,function*(){let r=yield sp(n.localStore,dt(e)),s=r.targetId,a=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",c;return i&&(c=yield Cp(n,e,s,a==="current",r.resumeToken)),n.isPrimaryClient&&t&&sh(n.remoteStore,r),c})}function Cp(n,e,t,i,r){return P(this,null,function*(){n.Ba=(I,E,S)=>function(V,A,G,H){return P(this,null,function*(){let Y=A.view.da(G);Y.Xi&&(Y=yield yu(V.localStore,A.query,!1).then(({documents:x})=>A.view.da(x,Y)));let re=H&&H.targetChanges.get(A.targetId),Ue=H&&H.targetMismatches.get(A.targetId)!=null,ee=A.view.applyChanges(Y,V.isPrimaryClient,re,Ue);return bu(V,A.targetId,ee.fa),ee.snapshot})}(n,I,E,S);let s=yield yu(n.localStore,e,!0),a=new tl(e,s.hs),c=a.da(s.documents),u=jn.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),f=a.applyChanges(c,n.isPrimaryClient,u);bu(n,t,f.fa);let p=new il(e,t,a);return n.ba.set(e,p),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),f.snapshot})}function Sp(n,e,t){return P(this,null,function*(){let i=B(n),r=i.ba.get(e),s=i.Da.get(r.targetId);if(s.length>1)return i.Da.set(r.targetId,s.filter(a=>!Ao(a,e))),void i.ba.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield qa(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&El(i.remoteStore,r.targetId),ol(i,r.targetId)}).catch(Wn))):(ol(i,r.targetId),yield qa(i.localStore,r.targetId,!0))})}function Dp(n,e){return P(this,null,function*(){let t=B(n),i=t.ba.get(e),r=t.Da.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),El(t.remoteStore,i.targetId))})}function Ap(n,e,t){return P(this,null,function*(){let i=Np(n);try{let r=yield function(a,c){let u=B(a),f=xe.now(),p=c.reduce((S,F)=>S.add(F.key),U()),I,E;return u.persistence.runTransaction("Locally write mutations","readwrite",S=>{let F=Et(),V=U();return u.os.getEntries(S,p).next(A=>{F=A,F.forEach((G,H)=>{H.isValidDocument()||(V=V.add(G))})}).next(()=>u.localDocuments.getOverlayedDocuments(S,F)).next(A=>{I=A;let G=[];for(let H of c){let Y=Mm(H,I.get(H.key).overlayedDocument);Y!=null&&G.push(new Ct(H.key,Y,Ru(Y.value.mapValue),Nt.exists(!0)))}return u.mutationQueue.addMutationBatch(S,f,G,c)}).next(A=>{E=A;let G=A.applyToLocalDocumentSet(I,V);return u.documentOverlayCache.saveOverlays(S,A.batchId,G)})}).then(()=>({batchId:E.batchId,changes:qu(I)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(a,c,u){let f=a.xa[a.currentUser.toKey()];f||(f=new le(W)),f=f.insert(c,u),a.xa[a.currentUser.toKey()]=f}(i,r.batchId,t),yield Jn(i,r.changes),yield Fo(i.remoteStore)}catch(r){let s=Al(r,"Failed to persist write");t.reject(s)}})}function fh(n,e){return P(this,null,function*(){let t=B(n);try{let i=yield np(t.localStore,e);e.targetChanges.forEach((r,s)=>{let a=t.Fa.get(s);a&&(Z(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?a.wa=!0:r.modifiedDocuments.size>0?Z(a.wa):r.removedDocuments.size>0&&(Z(a.wa),a.wa=!1))}),yield Jn(t,i,e)}catch(i){yield Wn(i)}})}function wu(n,e,t){let i=B(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.ba.forEach((s,a)=>{let c=a.view.j_(e);c.snapshot&&r.push(c.snapshot)}),function(a,c){let u=B(a);u.onlineState=c;let f=!1;u.queries.forEach((p,I)=>{for(let E of I.U_)E.j_(c)&&(f=!0)}),f&&Rl(u)}(i.eventManager,e),r.length&&i.Sa.h_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function Rp(n,e,t){return P(this,null,function*(){let i=B(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Fa.get(e),s=r&&r.key;if(s){let a=new le(O.comparator);a=a.insert(s,tt.newNoDocument(s,q.min()));let c=U().add(s),u=new so(q.min(),new Map,new le(W),a,c);yield fh(i,u),i.va=i.va.remove(s),i.Fa.delete(e),kl(i)}else yield qa(i.localStore,e,!1).then(()=>ol(i,e,t)).catch(Wn)})}function kp(n,e){return P(this,null,function*(){let t=B(n),i=e.batch.batchId;try{let r=yield ip(t.localStore,e);ph(t,i,null),mh(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield Jn(t,r)}catch(r){yield Wn(r)}})}function Pp(n,e,t){return P(this,null,function*(){let i=B(n);try{let r=yield function(a,c){let u=B(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let p;return u.mutationQueue.lookupMutationBatch(f,c).next(I=>(Z(I!==null),p=I.keys(),u.mutationQueue.removeMutationBatch(f,I))).next(()=>u.mutationQueue.performConsistencyCheck(f)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(f,p,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p)).next(()=>u.localDocuments.getDocuments(f,p))})}(i.localStore,e);ph(i,e,t),mh(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield Jn(i,r)}catch(r){yield Wn(r)}})}function mh(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function ph(n,e,t){let i=B(n),r=i.xa[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.xa[i.currentUser.toKey()]=r}}function ol(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Da.get(e))n.ba.delete(i),t&&n.Sa.ka(i,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(i=>{n.Ma.containsKey(i)||gh(n,i)})}function gh(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(El(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),kl(n))}function bu(n,e,t){for(let i of t)i instanceof xo?(n.Ma.addReference(i.key,e),Fp(n,i)):i instanceof wo?(M("SyncEngine","Document no longer in limbo: "+i.key),n.Ma.removeReference(i.key,e),n.Ma.containsKey(i.key)||gh(n,i.key)):L()}function Fp(n,e){let t=e.key,i=t.path.canonicalString();n.va.get(t)||n.Ca.has(i)||(M("SyncEngine","New document in limbo: "+t),n.Ca.add(i),kl(n))}function kl(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new O(ae.fromString(e)),i=n.Na.next();n.Fa.set(i,new nl(t)),n.va=n.va.insert(t,i),sh(n.remoteStore,new zn(dt(Nu(t.path)),i,"TargetPurposeLimboResolution",Su.oe))}}function Jn(n,e,t){return P(this,null,function*(){let i=B(n),r=[],s=[],a=[];i.ba.isEmpty()||(i.ba.forEach((c,u)=>{a.push(i.Ba(u,e,t).then(f=>{var p;if((f||t)&&i.isPrimaryClient){let I=f?!f.fromCache:(p=t?.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;i.sharedClientState.updateQueryState(u.targetId,I?"current":"not-current")}if(f){r.push(f);let I=Na.Ki(u.targetId,f);s.push(I)}}))}),yield Promise.all(a),i.Sa.h_(r),yield function(u,f){return P(this,null,function*(){let p=B(u);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>D.forEach(f,E=>D.forEach(E.qi,S=>p.persistence.referenceDelegate.addReference(I,E.targetId,S)).next(()=>D.forEach(E.Qi,S=>p.persistence.referenceDelegate.removeReference(I,E.targetId,S)))))}catch(I){if(!Yn(I))throw I;M("LocalStore","Failed to update sequence numbers: "+I)}for(let I of f){let E=I.targetId;if(!I.fromCache){let S=p.ns.get(E),F=S.snapshotVersion,V=S.withLastLimboFreeSnapshotVersion(F);p.ns=p.ns.insert(E,V)}}})}(i.localStore,s))})}function Mp(n,e){return P(this,null,function*(){let t=B(n);if(!t.currentUser.isEqual(e)){M("SyncEngine","User change. New user:",e.toKey());let i=yield rh(t.localStore,e);t.currentUser=e,function(s,a){s.Oa.forEach(c=>{c.forEach(u=>{u.reject(new N(C.CANCELLED,a))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield Jn(t,i.us)}})}function Vp(n,e){let t=B(n),i=t.Fa.get(e);if(i&&i.wa)return U().add(i.key);{let r=U(),s=t.Da.get(e);if(!s)return r;for(let a of s){let c=t.ba.get(a);r=r.unionWith(c.view.Ea)}return r}}function _h(n){let e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=fh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Vp.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Rp.bind(null,e),e.Sa.h_=bp.bind(null,e.eventManager),e.Sa.ka=Ip.bind(null,e.eventManager),e}function Np(n){let e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kp.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Pp.bind(null,e),e}var bo=class{constructor(){this.synchronizeTabs=!1}initialize(e){return P(this,null,function*(){this.serializer=ko(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return tp(this.persistence,new La,e.initialUser,this.serializer)}createPersistence(e){return new Fa(Va.Hr,this.serializer)}createSharedClientState(e){return new ja}terminate(){return P(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var sl=class{initialize(e,t){return P(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>wu(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Mp.bind(null,this.syncEngine),yield vp(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Ja}()}createDatastore(e){let t=ko(e.databaseInfo.databaseId),i=function(s){return new Ga(s)}(e.databaseInfo);return function(s,a,c,u){return new Ha(s,a,c,u)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,r,s,a,c){return new Wa(i,r,s,a,c)}(this.localStore,this.datastore,e.asyncQueue,t=>wu(this.syncEngine,t,0),function(){return mo.D()?new mo:new za}())}createSyncEngine(e,t){return function(r,s,a,c,u,f,p){let I=new rl(r,s,a,c,u,f);return p&&(I.La=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return P(this,null,function*(){var e;yield function(i){return P(this,null,function*(){let r=B(i);M("RemoteStore","RemoteStore shutting down."),r.M_.add(5),yield Xn(r),r.O_.shutdown(),r.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};var al=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):It("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var ll=class{constructor(e,t,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=_e.UNAUTHENTICATED,this.clientId=eo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,s=>P(this,null,function*(){M("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(i,s=>(M("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new N(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new lt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>P(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=Al(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function Ls(n,e){return P(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>P(this,null,function*(){i.isEqual(r)||(yield rh(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Iu(n,e){return P(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Lp(n);M("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>vu(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>vu(e.remoteStore,r)),n._onlineComponents=e})}function Op(n){return n.name==="FirebaseError"?n.code===C.FAILED_PRECONDITION||n.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function Lp(n){return P(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ls(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!Op(t))throw t;Mi("Error using user provided cache. Falling back to memory cache: "+t),yield Ls(n,new bo)}}else M("FirestoreClient","Using default OfflineComponentProvider"),yield Ls(n,new bo);return n._offlineComponents})}function yh(n){return P(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),yield Iu(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),yield Iu(n,new sl))),n._onlineComponents})}function Bp(n){return yh(n).then(e=>e.syncEngine)}function qp(n){return P(this,null,function*(){let e=yield yh(n),t=e.eventManager;return t.onListen=Tp.bind(null,e.syncEngine),t.onUnlisten=Sp.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Ep.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Dp.bind(null,e.syncEngine),t})}function jp(n,e,t={}){let i=new lt;return n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(s,a,c,u,f){let p=new al({next:E=>{a.enqueueAndForget(()=>wp(s,I)),E.fromCache&&u.source==="server"?f.reject(new N(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(E)},error:E=>f.reject(E)}),I=new el(c,p,{includeMetadataChanges:!0,ra:!0});return xp(s,I)}(yield qp(n),n.asyncQueue,e,t,i)})),i.promise}function vh(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Tu=new Map;function xh(n,e,t){if(!t)throw new N(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function zp(n,e,t,i){if(e===!0&&i===!0)throw new N(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Eu(n){if(!O.isDocumentKey(n))throw new N(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Cu(n){if(O.isDocumentKey(n))throw new N(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Pl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":L()}function Kn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new N(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Pl(n);throw new N(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Io=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new N(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new N(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zp("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vh((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new N(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new N(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new N(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Qi=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Io({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new N(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new N(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Io(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Bs;switch(i.type){case"firstParty":return new Us(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new N(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let i=Tu.get(t);i&&(M("ComponentProvider","Removing Datastore"),Tu.delete(t),i.terminate())}(this),Promise.resolve()}};function Up(n,e,t,i={}){var r;let s=(n=Kn(n,Qi))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Mi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),i.mockUserToken){let c,u;if(typeof i.mockUserToken=="string")c=i.mockUserToken,u=_e.MOCK_USER;else{c=cd(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new N(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new _e(f)}n._authCredentials=new qs(new Zr(c,u))}}var To=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},et=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ot(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Ot=class n extends To{constructor(e,t,i){super(e,t,Nu(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new et(this.firestore,null,new O(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Fl(n,e,...t){if(n=Ii(n),xh("collection","path",e),n instanceof Qi){let i=ae.fromString(e,...t);return Cu(i),new Ot(n,null,i)}{if(!(n instanceof et||n instanceof Ot))throw new N(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(ae.fromString(e,...t));return Cu(i),new Ot(n.firestore,null,i)}}function Ml(n,e,...t){if(n=Ii(n),arguments.length===1&&(e=eo.newId()),xh("doc","path",e),n instanceof Qi){let i=ae.fromString(e,...t);return Eu(i),new et(n,null,new O(i))}{if(!(n instanceof et||n instanceof Ot))throw new N(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(ae.fromString(e,...t));return Eu(i),new et(n.firestore,n instanceof Ot?n.converter:null,new O(i))}}var cl=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new po(this,"async_queue_retry"),this.hu=()=>{let t=Os();t&&M("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Os();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Os();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new lt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return P(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Yn(e))throw e;M("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(i=>{this.au=i,this.uu=!1;let r=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(i);throw It("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.uu=!1,i))));return this.iu=t,t}enqueueAfterDelay(e,t,i){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let r=Ya.createAndSchedule(this,e,t,i,s=>this.Eu(s));return this._u.push(r),r}Pu(){this.au&&L()}verifyOperationInProgress(){}du(){return P(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};var Hi=class extends Qi{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=function(){return new cl}(),this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Ih(this),this._firestoreClient.terminate()}};function wh(n,e){let t=typeof n=="object"?n:yd(),i=typeof n=="string"?n:e||"(default)",r=gd(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let s=ld("firestore");s&&Up(r,...s)}return r}function bh(n){return n._firestoreClient||Ih(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Ih(n){var e,t,i;let r=n._freezeSettings(),s=function(c,u,f,p){return new $s(c,u,f,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,vh(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._firestoreClient=new ll(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}var Qn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Me.fromBase64String(e))}catch(t){throw new N(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Me.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Hn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new N(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Eo=class{constructor(e){this._methodName=e}};var $n=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new N(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new N(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return W(this._lat,e._lat)||W(this._long,e._long)}};var Gp=/^__.*__$/,dl=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ct(e,this.data,this.fieldMask,t,this.fieldTransforms):new ci(e,this.data,t,this.fieldTransforms)}};function Th(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L()}}var ul=class n{constructor(e,t,i,r,s,a){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.gu({path:i,yu:!1});return r.wu(e),r}Su(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.gu({path:i,yu:!1});return r.mu(),r}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Co(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(Th(this.fu)&&Gp.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},hl=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||ko(e)}Fu(e,t,i,r=!1){return new ul({fu:e,methodName:t,vu:i,path:ze.emptyPath(),yu:!1,Cu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Kp(n){let e=n._freezeSettings(),t=ko(n._databaseId);return new hl(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Qp(n,e,t,i,r,s={}){let a=n.Fu(s.merge||s.mergeFields?2:0,e,t,r);Dh("Data must be an object, but it was:",a,i);let c=Ch(i,a),u,f;if(s.merge)u=new at(a.fieldMask),f=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let I of s.mergeFields){let E=Hp(e,I,t);if(!a.contains(E))throw new N(C.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);Wp(p,E)||p.push(E)}u=new at(p),f=a.fieldTransforms.filter(I=>u.covers(I.field))}else u=null,f=a.fieldTransforms;return new dl(new Ze(c),u,f)}function Eh(n,e){if(Sh(n=Ii(n)))return Dh("Unsupported field value:",e,n),Ch(n,e);if(n instanceof Eo)return function(i,r){if(!Th(r.fu))throw r.Du(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Du(`${i._methodName}() is not currently supported inside arrays`);let s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(i,r){let s=[],a=0;for(let c of i){let u=Eh(c,r.bu(a));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),a++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if((i=Ii(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Am(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let s=xe.fromDate(i);return{timestampValue:uo(r.serializer,s)}}if(i instanceof xe){let s=new xe(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:uo(r.serializer,s)}}if(i instanceof $n)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Qn)return{bytesValue:Xu(r.serializer,i._byteString)};if(i instanceof et){let s=r.databaseId,a=i.firestore._databaseId;if(!a.isEqual(s))throw r.Du(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Tl(i.firestore._databaseId||r.databaseId,i._key.path)}}throw r.Du(`Unsupported field value: ${Pl(i)}`)}(n,e)}function Ch(n,e){let t={};return Du(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wi(n,(i,r)=>{let s=Eh(r,e.pu(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function Sh(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xe||n instanceof $n||n instanceof Qn||n instanceof et||n instanceof Eo)}function Dh(n,e,t){if(!Sh(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let i=Pl(t);throw i==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+i)}}function Hp(n,e,t){if((e=Ii(e))instanceof Hn)return e._internalPath;if(typeof e=="string")return Ah(n,e);throw Co("Field path arguments must be of type string or ",n,!1,void 0,t)}var $p=new RegExp("[~\\*/\\[\\]]");function Ah(n,e,t){if(e.search($p)>=0)throw Co(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Hn(...e.split("."))._internalPath}catch{throw Co(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Co(n,e,t,i,r){let s=i&&!i.isEmpty(),a=r!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${i}`),a&&(u+=` in document ${r}`),u+=")"),new N(C.INVALID_ARGUMENT,c+n+u)}function Wp(n,e){return n.some(t=>t.isEqual(e))}var So=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new et(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new fl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Rh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},fl=class extends So{data(){return super.data()}};function Rh(n,e){return typeof e=="string"?Ah(n,e):e instanceof Hn?e._internalPath:e._delegate._internalPath}function Yp(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new N(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ml=class{convertValue(e,t="none"){switch(si(e)){case 0:return null;case 1:return e.booleanValue;case 2:return se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Lt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw L()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Wi(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new $n(se(e.latitude),se(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=xl(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Ln(e));default:return null}}convertTimestamp(e){let t=Tt(e);return new xe(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=ae.fromString(e);Z(nh(i));let r=new ro(i.get(1),i.get(3)),s=new O(i.popFirst(5));return r.isEqual(t)||It(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Xp(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var ki=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},pl=class extends So{constructor(e,t,i,r,s,a){super(e,t,i,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Fi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(Rh("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},Fi=class extends pl{data(e={}){return super.data(e)}},gl=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ki(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Fi(this._firestore,this._userDataWriter,i.key,i,new ki(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new N(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(c=>{let u=new Fi(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ki(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let u=new Fi(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ki(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),f=-1,p=-1;return c.type!==0&&(f=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:Jp(c.type),doc:u,oldIndex:f,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Jp(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L()}}var _l=class extends ml{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new et(this.firestore,null,t)}};function kh(n){n=Kn(n,To);let e=Kn(n.firestore,Hi),t=bh(e),i=new _l(e);return Yp(n._query),jp(t,n._query).then(r=>new gl(e,i,n,r))}function Ph(n){return Mh(Kn(n.firestore,Hi),[new qn(n._key,Nt.none())])}function Fh(n,e){let t=Kn(n.firestore,Hi),i=Ml(n),r=Xp(n.converter,e);return Mh(t,[Qp(Kp(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Nt.exists(!1))]).then(()=>i)}function Mh(n,e){return function(i,r){let s=new lt;return i.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return Ap(yield Bp(i),r,s)})),s.promise}(bh(n),e)}(function(e,t=!0){(function(r){$i=r})(_d),pd(new fd("firestore",(i,{instanceIdentifier:r,options:s})=>{let a=i.getProvider("app").getImmediate(),c=new Hi(new js(i.getProvider("auth-internal")),new Ks(i.getProvider("app-check-internal")),function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new N(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ro(f.options.projectId,p)}(a,r),a);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),ds(Zd,"4.6.4",e),ds(Zd,"4.6.4","esm2017")})();var Mo=(()=>{let e=class e{constructor(){this.db=wh()}createUser(i){return P(this,null,function*(){i.id=Date.now().toString(36)+Math.random().toString(36).substr(2);let r=yield Fh(Fl(this.db,"users"),i);console.log("Document written with ID: ",r.id)})}getAllUsers(){return P(this,null,function*(){let i=[];return(yield kh(Fl(this.db,"users"))).forEach(s=>{i.push(gr(He({},s.data()),{id:s.id}))}),i})}deleteUser(i){return P(this,null,function*(){return yield Ph(Ml(this.db,"users",i)),!0})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=_t({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function tg(n,e){n&1&&(z(0,"div")(1,"p",13),J(2," Invalid Name Field"),j()())}function ig(n,e){n&1&&(z(0,"div")(1,"p",13),J(2," Invalid Name Field"),j()())}function ng(n,e){n&1&&(z(0,"div")(1,"p",13),J(2," Invalid Name Field"),j()())}var Nh=(()=>{let e=class e{constructor(i,r,s,a){this.db=i,this.dialogRef=r,this.data=s,this.fb=a,this.myForm=this.fb.group({name:["Owais Azam",Cn.required],email:["iamowaisazam@gmail.com",[Cn.required,Cn.email]],password:["owais123",[Cn.required]]})}onSubmit(){this.myForm.valid?this.db.createUser(this.myForm.value):console.log("Form Submitted!",this.myForm),this.dialogRef.close()}cancelForm(){this.dialogRef.close()}};e.\u0275fac=function(r){return new(r||e)(k(Mo),k(Ei),k(Ss),k(id))},e.\u0275cmp=pe({type:e,selectors:[["app-add-user"]],standalone:!0,features:[ge],decls:26,vars:4,consts:[["youform",""],["mat-dialog-title","",2,"text-align","center"],[3,"ngSubmit","formGroup"],[1,"mat-typography"],["fxLayout","column wrap","fxLayoutWrap","wrap","fxLayoutGap","5px",2,"width","95%"],["fxFlex","100%"],["matInput","","formControlName","name","placeholder","Name",1,"mat-mdc-input-element"],[4,"ngIf"],["formControlName","email","matInput","","placeholder","Email",1,"mat-mdc-input-element"],["formControlName","password","matInput","","placeholder","Password",1,"mat-mdc-input-element"],["align","end"],["color","primary","type","button","mat-flat-button","",3,"click"],["color","accent","type","submit","mat-flat-button",""],[1,"mat-body1",2,"color","red"]],template:function(r,s){if(r&1){let a=_i();z(0,"h2",1),J(1,"Create New User Form"),j(),z(2,"form",2,0),Ke("ngSubmit",function(){return kt(a),Pt(s.onSubmit())}),z(4,"mat-dialog-content",3)(5,"div",4)(6,"div",5)(7,"mat-label"),J(8,"Name"),j(),vt(9,"input",6),de(10,tg,3,0,"div",7),j(),z(11,"div",5)(12,"mat-label"),J(13,"Email"),j(),vt(14,"input",8),de(15,ig,3,0,"div",7),j(),z(16,"div",5)(17,"mat-label"),J(18,"Password"),j(),vt(19,"input",9),de(20,ng,3,0,"div",7),j()()(),z(21,"mat-dialog-actions",10)(22,"button",11),Ke("click",function(){return kt(a),Pt(s.cancelForm())}),J(23,"Cancel"),j(),z(24,"button",12),J(25,"Submit"),j()()()}r&2&&(ce(2),We("formGroup",s.myForm),ce(8),We("ngIf",s.myForm==null||s.myForm.controls==null||s.myForm.controls.name==null?null:s.myForm.controls.name.errors),ce(5),We("ngIf",s.myForm==null||s.myForm.controls==null||s.myForm.controls.email==null?null:s.myForm.controls.email.errors),ce(5),We("ngIf",s.myForm==null||s.myForm.controls==null||s.myForm.controls.password==null?null:s.myForm.controls.password.errors))},dependencies:[Ar,Dr,Yd,Hd,Wd,$d,Vr,Pr,Fr,Mr,Mt,jc,wt,Od,Nr,Rr,Zc,Yc,Xc,Jc,ed,td],styles:[".mat-mdc-dialog-title[_ngcontent-%COMP%]{text-align:center;border-bottom:1px solid lightgray;margin:0;line-height:0;padding-bottom:24px}"],changeDetection:0});let n=e;return n})();function rg(n,e){n&1&&(z(0,"th",15),J(1," ID. "),j())}function og(n,e){if(n&1&&(z(0,"td",16),J(1),j()),n&2){let t=e.$implicit;ce(),Jt(" ",t.id," ")}}function sg(n,e){n&1&&(z(0,"th",15),J(1," Name "),j())}function ag(n,e){if(n&1&&(z(0,"td",16),J(1),j()),n&2){let t=e.$implicit;ce(),Jt(" ",t.name," ")}}function lg(n,e){n&1&&(z(0,"th",15),J(1," Email "),j())}function cg(n,e){if(n&1&&(z(0,"td",16),J(1),j()),n&2){let t=e.$implicit;ce(),Jt(" ",t.email," ")}}function dg(n,e){n&1&&(z(0,"th",15),J(1," Action "),j())}function ug(n,e){if(n&1){let t=_i();z(0,"td",16),J(1),z(2,"button",17),Ke("click",function(){kt(t);let r=Xt();return Pt(r.openDialog())}),J(3,"Edit"),j(),z(4,"button",18),Ke("click",function(){let r=kt(t).$implicit,s=Xt();return Pt(s.deleteUser(r.id))}),J(5,"Delete"),j()()}if(n&2){let t=e.$implicit;ce(),Jt(" ",t.action," ")}}function hg(n,e){n&1&&vt(0,"tr",19)}function fg(n,e){n&1&&vt(0,"tr",20)}var Ev=(()=>{let e=class e{constructor(i){this.db=i,this.dialog=ke(Qr),this.displayedColumns=["id","name","email","action"],this.dataSource=[],this.getUsrs()}getUsrs(){return P(this,null,function*(){let i=yield this.db.getAllUsers(),r=[];i.forEach(s=>{r.push({id:s.id,name:s.name,email:s.email})}),this.dataSource=r})}deleteUser(i){return P(this,null,function*(){(yield this.db.deleteUser(i))&&this.getUsrs()})}openDialog(){this.dialog.open(Nh,{width:"500px"}).afterClosed().subscribe(r=>{this.getUsrs()})}};e.\u0275fac=function(r){return new(r||e)(k(Mo))},e.\u0275cmp=pe({type:e,selectors:[["app-users"]],standalone:!0,features:[ge],decls:27,vars:3,consts:[["fxLayout","row","fxLayoutAlign","","fxLayoutGap","20px"],["fxFlex","auto",1,"my-table"],[2,"display","block","width","100%"],["fxLayout","row wrap","fxLayoutAlign","space-between"],[1,"mat-h2"],["mat-flat-button","","color","primary",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-flat-button","","color","accent",2,"margin-right","5px",3,"click"],["mat-flat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(r,s){r&1&&(z(0,"div",0)(1,"div",1)(2,"mat-card")(3,"mat-card-header")(4,"div",2)(5,"div",3)(6,"p",4),J(7,"Users List"),j(),z(8,"p")(9,"button",5),Ke("click",function(){return s.openDialog()}),J(10,"Add New"),j()()()()(),z(11,"mat-card-content")(12,"table",6),Wt(13,7),de(14,rg,2,0,"th",8)(15,og,2,1,"td",9),Yt(),Wt(16,10),de(17,sg,2,0,"th",8)(18,ag,2,1,"td",9),Yt(),Wt(19,11),de(20,lg,2,0,"th",8)(21,cg,2,1,"td",9),Yt(),Wt(22,12),de(23,dg,2,0,"th",8)(24,ug,6,1,"td",9),Yt(),de(25,hg,1,0,"tr",13)(26,fg,1,0,"tr",14),j()()()()()),r&2&&(ce(12),We("dataSource",s.dataSource),ce(13),We("matHeaderRowDef",s.displayedColumns),ce(),We("matRowDefColumns",s.displayedColumns))},dependencies:[Vr,Pr,Fr,rd,Mr,Mt,Nd,Cd,Dd,Pd,Ad,Sd,Fd,Rd,kd,Md,Vd,Ld,qd,wt,Ar,Dr,Nr,od,sd,ad,Rr],styles:["table[_ngcontent-%COMP%]{width:100%}"]});let n=e;return n})();export{Ev as UsersComponent};
